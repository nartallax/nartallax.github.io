{"mappings":"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","sources":["src/sketches/random_rhombus_tilings/random_rhombus_tilings.ts","src/sketches/random_rhombus_tilings/rhombus_tiling_render.ts","src/common/color_utils.ts","src/sketches/random_rhombus_tilings/rhombus_tiling.ts","src/common/perfometer.ts","src/sketches/random_rhombus_tilings/triangle_grid.ts","src/common/queue.ts","src/sketches/random_rhombus_tilings/rhombus_randomizer.binding.ts","node_modules/@parcel/runtime-js/lib/runtime-be2eac7296bd2141.js","node_modules/@parcel/runtime-js/lib/helpers/bundle-manifest.js","src/sketches/random_rhombus_tilings/wasm/rhombus_randomiser.js","src/common/bottom_bar/bottom_bar.ts","src/common/bottom_bar/bottom_bar.module.scss","src/common/slider/slider.ts","src/common/input_utils.ts","src/common/slider/slider.module.scss","src/common/debounce.ts"],"sourcesContent":["import {renderRhombuses} from \"sketches/random_rhombus_tilings/rhombus_tiling_render\"\nimport {getEmptyRhombusPattern, rhombusGridFromBytes, rhombusGridToBytes} from \"sketches/random_rhombus_tilings/rhombus_tiling\"\nimport {transformColorHsl} from \"common/color_utils\"\nimport {performeter} from \"common/perfometer\"\nimport {getWasmRhombusRandomiser, WasmRhombusRandomiser} from \"sketches/random_rhombus_tilings/rhombus_randomizer.binding\"\nimport {makeBottomBarredScreenContainer} from \"common/bottom_bar/bottom_bar\"\nimport {box, RBox, WBox} from \"@nartallax/cardboard\"\nimport {Slider} from \"common/slider/slider\"\nimport {TriangleGrid} from \"sketches/random_rhombus_tilings/triangle_grid\"\nimport {debounce} from \"common/debounce\"\nimport {bindBox, tag} from \"@nartallax/cardboard-dom\"\n\nconst colors = [0x53bc01, 0xffeb03, 0xffa801, 0xf93a1d, 0xe21a5f, 0x572c62, 0xa1ccd3, 0x006898] as const\nconst defaultDims = {width: 10, height: 10, length: 10}\nconst defaultSteps = Math.floor(TriangleGrid.getCount(defaultDims.length, defaultDims.width, defaultDims.height) * 10)\nconst defaultSeed = Math.floor(Math.random() * 0x8fffffff)\n\nexport async function main(container: HTMLElement, {isPreview}: {isPreview: boolean}): Promise<void> {\n\tconst randomizer = await getWasmRhombusRandomiser()\n\tconst redraw = makeUpdater(() => root, randomizer)\n\tconst debouncedRedraw = debounce(\"raf\", () => redraw(props))\n\n\tconst steps = box(defaultSteps)\n\tconst maxSteps = box(steps.get())\n\tconst props = {\n\t\tcolor: box(colors[Math.floor(Math.random() * colors.length)]!),\n\t\tseed: box(defaultSeed),\n\t\tsteps, maxSteps,\n\t\theight: box(defaultDims.height),\n\t\twidth: box(defaultDims.width),\n\t\tlength: box(defaultDims.length)\n\t}\n\tconst root = isPreview ? container : bottomBar(container, props)\n\n\tconst update = () => {\n\t\tdebouncedRedraw()\n\t\tmaxSteps.set(Math.floor(TriangleGrid.getCount(props.length.get(), props.width.get(), props.height.get()) ** 1.5))\n\t}\n\tupdate()\n\n\tbindBox(root, [props.steps, props.height, props.width, props.length, props.color, props.seed], update)\n}\n\nconst margins = 25\n\nconst makeUpdater = (getRoot: () => HTMLElement, randomizer: WasmRhombusRandomiser) => (props: BarProps) => {\n\trandomizer.seedRandom(props.seed.get())\n\tperformeter.enterBlock(\"initializing\")\n\tconst dims = {\n\t\theight: props.height.get(),\n\t\tlength: props.length.get(),\n\t\twidth: props.width.get()\n\t}\n\tconsole.log({...dims, steps: props.steps.get(), seed: props.seed.get()})\n\tlet grid = getEmptyRhombusPattern(dims)\n\n\tperformeter.exitEnterBlock(\"randomizing\")\n\tconst bytes = randomizer.randomizeRhombusPattern(rhombusGridToBytes(grid), props.length.get(), props.width.get(), props.height.get(), props.steps.get())\n\tgrid = rhombusGridFromBytes(bytes, dims)\n\t// tileWithRandomRhombuses(grid, props.steps())\n\n\tperformeter.exitEnterBlock(\"drawing\")\n\n\tconst color = props.color.get()\n\n\tconst root = getRoot()\n\troot.innerHTML = \"\"\n\n\tconst rootRect = root.getBoundingClientRect()\n\tconst rootHeight = rootRect.height - (margins * 2)\n\tconst rootWidth = rootRect.width - (margins * 2)\n\tconst heightCellSize = Math.floor(rootHeight / (grid.yHeight + 1))\n\tconst widthCellSize = Math.floor(rootWidth / (grid.xWidth + 1))\n\tconst cellSize = Math.min(heightCellSize, widthCellSize)\n\n\tconst svg = renderRhombuses({\n\t\thorisontalColor: transformColorHsl(color, ([h, s, l]) => [h, s * 1.1, l]),\n\t\tleftColor: transformColorHsl(color, ([h, s, l]) => [h, s * 0.9, l * 0.9]),\n\t\trightColor: transformColorHsl(color, ([h, s, l]) => [h, s * 0.9, l * 0.8]),\n\t\tcellSize: {\n\t\t\tx: cellSize,\n\t\t\ty: cellSize\n\t\t},\n\t\tgrid\n\t})\n\t// debug render\n\t// const svg = renderRhombusDots(grid, xy => {\n\t// \tconst encoded = randomizer.getNeighbours(dims.length, dims.width, dims.height, grid.count, xy.x, xy.y)\n\t// \treturn [...encoded].filter(x => x !== -1).map(num => ({\n\t// \t\tx: (num & 0xff0000) >> 16,\n\t// \t\ty: num & 0xff\n\t// \t}))\n\t// })\n\tsvg.style.margin = cellSize === widthCellSize\n\t\t? `${(rootRect.height - ((grid.yHeight + 1) * cellSize)) / 2}px 0 0 ${margins}px`\n\t\t: `${margins}px 0 0 ${(rootRect.width - ((grid.xWidth + 1) * cellSize)) / 2}px`\n\troot.appendChild(svg)\n\n\tperformeter.exitBlock()\n\tperformeter.print()\n\n\tconsole.log(randomizer.getMetrics())\n}\n\n\ninterface BarProps {\n\tsteps: WBox<number>\n\tmaxSteps: RBox<number>\n\tlength: WBox<number>\n\twidth: WBox<number>\n\theight: WBox<number>\n\tcolor: WBox<number>\n\tseed: WBox<number>\n}\n\nconst labelWidth = 60\nconst maxDim = 50\n\nfunction bottomBar(root: HTMLElement, props: BarProps): HTMLElement {\n\treturn makeBottomBarredScreenContainer({\n\t\tparent: root,\n\t\tcontents: [\n\t\t\ttag({style: {width: \"100%\", display: \"flex\", flexDirection: \"row\", justifyContent: \"flex-start\", gap: \"1rem\"}}, [\n\t\t\t\tSlider({\n\t\t\t\t\tvalue: props.steps,\n\t\t\t\t\tstep: 1,\n\t\t\t\t\tmin: 0,\n\t\t\t\t\tmax: props.maxSteps,\n\t\t\t\t\tlabel: \"Steps\",\n\t\t\t\t\tlabelWidth\n\t\t\t\t}),\n\t\t\t\ttag({\n\t\t\t\t\ttag: \"button\",\n\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\tprops.color.set(colors[Math.floor(Math.random() * colors.length)]!)\n\t\t\t\t\t\tprops.seed.set(Math.floor(Math.random() * 0x8fffffff))\n\t\t\t\t\t}\n\t\t\t\t}, [\"Refresh\"])\n\t\t\t]),\n\t\t\tSlider({\n\t\t\t\tvalue: props.length,\n\t\t\t\tstep: 1,\n\t\t\t\tmin: 2,\n\t\t\t\tmax: maxDim,\n\t\t\t\tlabel: \"Length\",\n\t\t\t\tlabelWidth\n\t\t\t}),\n\t\t\tSlider({\n\t\t\t\tvalue: props.width,\n\t\t\t\tstep: 1,\n\t\t\t\tmin: 2,\n\t\t\t\tmax: maxDim,\n\t\t\t\tlabel: \"Width\",\n\t\t\t\tlabelWidth\n\t\t\t}),\n\t\t\tSlider({\n\t\t\t\tvalue: props.height,\n\t\t\t\tstep: 1,\n\t\t\t\tmin: 2,\n\t\t\t\tmax: maxDim,\n\t\t\t\tlabel: \"Height\",\n\t\t\t\tlabelWidth\n\t\t\t})\n\t\t]\n\t})\n}","import {svgTag} from \"@nartallax/cardboard-dom\"\nimport {rgbNumberToColorString} from \"common/color_utils\"\nimport {RhombusGrid} from \"sketches/random_rhombus_tilings/rhombus_tiling\"\nimport {TriangleGrid, XY} from \"sketches/random_rhombus_tilings/triangle_grid\"\n\ninterface Props {\n\treadonly cellSize: XY\n\treadonly horisontalColor: number\n\treadonly leftColor: number\n\treadonly rightColor: number\n\treadonly grid: RhombusGrid\n}\n\nexport const renderRhombuses = (props: Props): SVGSVGElement => {\n\tconst grid = props.grid\n\tconst svg = svgTag({tag: \"svg\"})\n\n\tsvg.setAttribute(\"width\", grid.xWidth + \"\")\n\tsvg.setAttribute(\"height\", grid.yHeight + \"\")\n\tsvg.setAttribute(\"viewBox\", `-1 -1 ${grid.xWidth + 1} ${grid.yHeight + 0.5}`)\n\tsvg.style.width = ((grid.xWidth + 1) * props.cellSize.x) + \"px\"\n\tsvg.style.height = ((grid.yHeight + 0.5) * props.cellSize.y) + \"px\"\n\n\tconst strokeWidth = 2 / (props.cellSize.x + props.cellSize.y)\n\tconst makePathMaker = (color: number, name: string, expr: (x: number, y: number) => string) => (x: number, y: number): SVGPathElement => {\n\t\tlet offset = grid.getVerticalOffset(Math.max(0, Math.min(grid.xWidth - 1, x)))\n\t\tif(x < 0 || x >= grid.xWidth){\n\t\t\toffset += 0.5\n\t\t}\n\t\treturn svgTag({\n\t\t\ttag: \"path\",\n\t\t\tattrs: {\n\t\t\t\t\"data-name\": `${name} at ${x},${y} with offset ${offset}`,\n\t\t\t\td: expr(x, y + offset),\n\t\t\t\tfill: rgbNumberToColorString(color),\n\t\t\t\t// strokes are only required to fill small gaps between the elements\n\t\t\t\t// if all the lines were cardinal - there would be no gaps, but they are not\n\t\t\t\tstroke: rgbNumberToColorString(color),\n\t\t\t\t\"stroke-width\": strokeWidth\n\t\t\t}\n\t\t})\n\t}\n\n\tconst makeLeft = makePathMaker(\n\t\tprops.leftColor,\n\t\t\"left\",\n\t\t(x, y) => `M ${x} ${y} V ${y - 1} L ${x - 1} ${y - 0.5} V ${y + 0.5} z`)\n\n\tconst makeRight = makePathMaker(\n\t\tprops.rightColor,\n\t\t\"right\",\n\t\t(x, y) => `M ${x} ${y} V ${y - 1} L ${x + 1} ${y - 0.5} V ${y + 0.5} z`)\n\n\tconst makeBottom = makePathMaker(\n\t\tprops.horisontalColor,\n\t\t\"bottom\",\n\t\t(x, y) => `M ${x} ${y} L ${x - 1} ${y + 0.5} L ${x} ${y + 1} L ${x + 1} ${y + 0.5} z`)\n\n\tfor(const {x, y, value: {leftIsSolid, rightIsSolid, bottomIsSolid}} of props.grid){\n\t\tif(leftIsSolid){\n\t\t\tsvg.appendChild(makeLeft(x, y))\n\t\t}\n\t\tif(rightIsSolid){\n\t\t\tsvg.appendChild(makeRight(x, y))\n\t\t}\n\t\tif(bottomIsSolid){\n\t\t\tsvg.appendChild(makeBottom(x, y))\n\t\t}\n\t}\n\n\t// filling borders\n\tgrid.exploreFrom(grid.getTopCornerCoords(), xy => {\n\t\tgrid.get(xy).leftIsSolid || svg.appendChild(makeBottom(xy.x, xy.y - 1))\n\t\treturn [grid.getBottomLeftOf(xy)]\n\t})\n\n\tgrid.exploreFrom(grid.getTopCornerCoords(), xy => {\n\t\tgrid.get(xy).rightIsSolid || svg.appendChild(makeBottom(xy.x, xy.y - 1))\n\t\treturn [grid.getBottomRightOf(xy)]\n\t})\n\n\tgrid.exploreFrom(grid.getRightBottomCornerCoords(), xy => {\n\t\tgrid.get(xy).rightIsSolid || svg.appendChild(makeLeft(xy.x + 1, xy.y))\n\t\treturn [grid.getTopOf(xy)]\n\t})\n\n\tgrid.exploreFrom(grid.getRightBottomCornerCoords(), xy => {\n\t\tgrid.get(xy).bottomIsSolid || svg.appendChild(makeLeft(xy.x + 1, xy.y + (xy.x < grid.topCornerColumnX ? 1 : 0)))\n\t\treturn [grid.getBottomLeftOf(xy)]\n\t})\n\n\tgrid.exploreFrom(grid.getLeftBottomCornerCoords(), xy => {\n\t\tgrid.get(xy).bottomIsSolid || svg.appendChild(makeRight(xy.x - 1, xy.y + (xy.x > grid.topCornerColumnX ? 1 : 0)))\n\t\treturn [grid.getBottomRightOf(xy)]\n\t})\n\n\tgrid.exploreFrom(grid.getLeftBottomCornerCoords(), xy => {\n\t\tgrid.get(xy).leftIsSolid || svg.appendChild(makeRight(xy.x - 1, xy.y))\n\t\treturn [grid.getTopOf(xy)]\n\t})\n\n\t// debug dots\n\t// for(const {x, y} of grid){\n\t// \tsvg.appendChild(svgTag({tagName: \"circle\", attrs: {\n\t// \t\tcx: x, cy: y + grid.getVerticalOffset(x), r: 0.1, fill: \"white\", stroke: \"none\"\n\t// \t}}))\n\t// }\n\n\treturn svg\n}\n\n// that's mostly for debug\nexport const renderRhombusDots = (grid: TriangleGrid<unknown>, getNeighbours?: (xy: XY) => XY[]): SVGSVGElement => {\n\tconst cellSizePx = 20\n\tconst dotSizePx = 10\n\n\tconst doGetNeighbours = getNeighbours ?? (xy => grid.getValidNeighbourCoords(xy))\n\n\tconst svg = svgTag({tag: \"svg\"})\n\tsvg.setAttribute(\"width\", grid.xWidth + \"\")\n\tsvg.setAttribute(\"height\", grid.yHeight + \"\")\n\tsvg.setAttribute(\"viewBox\", `-1 -1 ${grid.xWidth + 1} ${grid.yHeight + 1}`)\n\tsvg.style.width = (grid.xWidth * cellSizePx) + \"px\"\n\tsvg.style.height = (grid.yHeight * cellSizePx) + \"px\"\n\n\tconst findDot = ({x, y}: XY): SVGCircleElement | null => {\n\t\tconst el = svg.getElementById(`circle-${x}-${y}`)\n\t\treturn el instanceof SVGCircleElement ? el : null\n\t}\n\n\tconst setColor = (xy: XY, color: string) => {\n\t\tconst dot = findDot(xy)\n\t\tif(dot){\n\t\t\tdot.style.fill = color\n\t\t}\n\t}\n\n\tconst showNeighbours = (xy: XY) => doGetNeighbours(xy)\n\t\t.forEach(xy => setColor(xy, \"red\"))\n\n\tconst hideNeighbours = (xy: XY) => doGetNeighbours(xy)\n\t\t.forEach(xy => setColor(xy, \"white\"))\n\n\tfor(const xy of grid){\n\t\tconst circle = svgTag({\n\t\t\ttag: \"circle\",\n\t\t\tattrs: {\n\t\t\t\tid: `circle-${xy.x}-${xy.y}`,\n\t\t\t\tcx: xy.x,\n\t\t\t\tcy: grid.getVerticalOffset(xy.x) + xy.y,\n\t\t\t\tr: dotSizePx / cellSizePx,\n\t\t\t\tfill: \"white\",\n\t\t\t\tstroke: \"none\"\n\t\t\t}\n\t\t})\n\n\t\tcircle.addEventListener(\"mouseover\", () => showNeighbours(xy))\n\t\tcircle.addEventListener(\"mouseout\", () => hideNeighbours(xy))\n\n\t\tsvg.appendChild(circle)\n\t}\n\n\treturn svg\n}","function twoHex(x: number): string {\n\treturn (x > 0xf ? \"\" : \"0\") + x.toString(16)\n}\n\nexport function colorNumberTo3Components(color: number): [r: number, g: number, b: number] {\n\tconst r = (color >> 16) & 0xff,\n\t\tg = (color >> 8) & 0xff,\n\t\tb = (color >> 0) & 0xff\n\treturn [r, g, b]\n}\n\nexport function color3ComponentsToNumber(components: [r: number, g: number, b: number]): number {\n\tconst [r, g, b] = components\n\treturn (r << 16) | (g << 8) | b\n}\n\nexport function rgbToHsl(color: number): number {\n\tlet [r, g, b] = colorNumberTo3Components(color)\n\t// Make r, g, and b fractions of 1\n\tr /= 255\n\tg /= 255\n\tb /= 255\n\n\t// Find greatest and smallest channel values\n\tconst cmin = Math.min(r, g, b),\n\t\tcmax = Math.max(r, g, b),\n\t\tdelta = cmax - cmin\n\tlet h = 0,\n\t\ts = 0,\n\t\tl = 0\n\n\t// Calculate hue\n\t// No difference\n\tif(delta === 0){\n\t\th = 0\n\t} else if(cmax === r){\n\t\t// Red is max\n\t\th = ((g - b) / delta) % 6\n\t} else if(cmax === g){\n\t\t// Green is max\n\t\th = (b - r) / delta + 2\n\t} else {\n\t\t// Blue is max\n\t\th = (r - g) / delta + 4\n\t}\n\n\th = Math.round(h * 60)\n\n\t// Make negative hues positive behind 360°\n\tif(h < 0){\n\t\th += 360\n\t}\n\n\t// Calculate lightness\n\tl = (cmax + cmin) / 2\n\n\t// Calculate saturation\n\ts = delta === 0 ? 0 : delta / (1 - Math.abs(2 * l - 1))\n\n\t// Multiply l and s by 100\n\ts = +(s * 100).toFixed(1)\n\tl = +(l * 100).toFixed(1)\n\n\treturn color3ComponentsToNumber([(h / 360) * 255, (s / 100) * 255, (l / 100) * 255])\n}\n\nexport function hslToRgb(hsl: number): number {\n\tlet [h, s, l] = colorNumberTo3Components(hsl)\n\th /= 255\n\ts /= 255\n\tl /= 255\n\tlet r: number, g: number, b: number\n\n\tif(s === 0){\n\t\tr = g = b = l // achromatic\n\t} else {\n\t\tconst q = l < 0.5 ? l * (1 + s) : l + s - l * s\n\t\tconst p = 2 * l - q\n\t\tr = hueToRgb(p, q, h + 1 / 3)\n\t\tg = hueToRgb(p, q, h)\n\t\tb = hueToRgb(p, q, h - 1 / 3)\n\t}\n\n\treturn color3ComponentsToNumber([Math.floor(r * 255), Math.floor(g * 255), Math.floor(b * 255)])\n}\n\nfunction hueToRgb(p: number, q: number, t: number): number {\n\tif(t < 0){\n\t\tt += 1\n\t}\n\tif(t > 1){\n\t\tt -= 1\n\t}\n\tif(t < 1 / 6){\n\t\treturn p + (q - p) * 6 * t\n\t}\n\tif(t < 1 / 2){\n\t\treturn q\n\t}\n\tif(t < 2 / 3){\n\t\treturn p + (q - p) * (2 / 3 - t) * 6\n\t}\n\treturn p\n}\n\nexport function rgbNumberToColorString(rgb: number): string {\n\tconst b = rgb & 0xff\n\trgb >>= 8\n\tconst g = rgb & 0xff\n\trgb >>= 8\n\tconst r = rgb & 0xff\n\n\treturn \"#\" + twoHex(r) + twoHex(g) + twoHex(b)\n}\n\nexport function transformColorHsl(colorRgb: number, transform: (hsl: [number, number, number]) => [number, number, number]): number {\n\tconst transformResult = transform(\n\t\tcolorNumberTo3Components(\n\t\t\trgbToHsl(colorRgb)\n\t\t)\n\t)\n\ttransformResult[0] = Math.max(0, Math.min(255, Math.round(transformResult[0])))\n\ttransformResult[1] = Math.max(0, Math.min(255, Math.round(transformResult[1])))\n\ttransformResult[2] = Math.max(0, Math.min(255, Math.round(transformResult[2])))\n\treturn hslToRgb(\n\t\tcolor3ComponentsToNumber(\n\t\t\ttransformResult\n\t\t)\n\t)\n}","import {performeter} from \"common/perfometer\"\nimport {decodeXY, encodeXY, TriangleGrid, XY} from \"sketches/random_rhombus_tilings/triangle_grid\"\n\n// this all is very inoptimal, and can be stored in a few bits\n// but whatever, it's not heavy enough to lag anyway\nexport interface TriangleGridRhombusNode {\n\treadonly leftIsSolid: boolean\n\treadonly rightIsSolid: boolean\n\treadonly bottomIsSolid: boolean\n}\n\nexport type RhombusGrid = TriangleGrid<TriangleGridRhombusNode>\n\nexport function rhombusGridToBytes(grid: RhombusGrid): Uint8Array {\n\tconst result = new Uint8Array(grid.count)\n\tconst colStarts = calcColStarts(grid)\n\n\tfor(const {x, y, value: {bottomIsSolid, leftIsSolid, rightIsSolid}} of grid){\n\t\tconst value = (rightIsSolid ? 1 : 0) | (bottomIsSolid ? 2 : 0) | (leftIsSolid ? 4 : 0)\n\t\tconst index = colStarts[x]! + y\n\t\tresult[index] = value\n\t}\n\n\treturn result\n}\n\nexport function rhombusGridFromBytes(bytes: Uint8Array, props: {width: number, height: number, length: number}): RhombusGrid {\n\tconst grid = new TriangleGrid({\n\t\t...props,\n\t\tdefaultValue: {\n\t\t\tleftIsSolid: false,\n\t\t\trightIsSolid: false,\n\t\t\tbottomIsSolid: false\n\t\t}\n\t})\n\tconst colStarts = calcColStarts(grid)\n\tfor(const xy of grid){\n\t\tconst index = colStarts[xy.x]! + xy.y\n\t\tconst byte = bytes[index]!\n\t\tgrid.set(xy, {\n\t\t\trightIsSolid: (byte & 1) !== 0,\n\t\t\tbottomIsSolid: (byte & 2) !== 0,\n\t\t\tleftIsSolid: (byte & 4) !== 0\n\t\t})\n\t}\n\treturn grid\n}\n\nfunction calcColStarts(grid: RhombusGrid): number[] {\n\tconst colStarts: number[] = new Array(grid.xWidth).fill(0)\n\tfor(let x = 1; x < grid.xWidth; x++){\n\t\tcolStarts[x] = colStarts[x - 1]! + grid.getHeightOfColumnAt(x - 1)\n\t}\n\treturn colStarts\n}\n\n// horisontal places at the bottom\nexport const getEmptyRhombusPattern = (props: {width: number, height: number, length: number}): RhombusGrid => {\n\tconst grid = new TriangleGrid<TriangleGridRhombusNode>({\n\t\t...props,\n\t\tdefaultValue: {\n\t\t\tleftIsSolid: false,\n\t\t\trightIsSolid: false,\n\t\t\tbottomIsSolid: false\n\t\t}\n\t})\n\n\tconst center = grid.getCenterCornerCoords()\n\n\tgrid.exploreFrom(center, xy => {\n\t\tgrid.set(xy, {...grid.get(xy), bottomIsSolid: true})\n\t\treturn [grid.getBottomLeftOf(xy), grid.getBottomRightOf(xy), grid.getBottomOf(xy)]\n\t})\n\n\tgrid.exploreFrom(center, xy => {\n\t\tgrid.set(xy, {...grid.get(xy), leftIsSolid: true})\n\t\treturn [grid.getBottomLeftOf(xy), grid.getTopLeftOf(xy), grid.getTopOf(xy)]\n\t})\n\n\tgrid.exploreFrom(center, xy => {\n\t\tgrid.set(xy, {...grid.get(xy), rightIsSolid: true})\n\t\treturn [grid.getBottomRightOf(xy), grid.getTopRightOf(xy), grid.getTopOf(xy)]\n\t})\n\n\treturn grid\n}\n\nexport const tileWithRandomRhombuses = (grid: RhombusGrid, flipLimit: number): void => {\n\tconst flippables = new Set<number>([encodeXY(grid.getCenterCornerCoords())])\n\n\tconst updateNeighbours = (sourceXy: XY) => {\n\t\tfor(const xy of grid.getValidNeighbourCoords(sourceXy)){\n\t\t\tconst key = encodeXY(xy)\n\t\t\tif(canFlipAt(xy)){\n\t\t\t\tflippables.add(key)\n\t\t\t} else {\n\t\t\t\tflippables.delete(key)\n\t\t\t}\n\t\t}\n\t}\n\n\tconst isConcaveCorner = (node: TriangleGridRhombusNode) => node.bottomIsSolid && node.leftIsSolid && node.rightIsSolid\n\tconst canFlipAt = (xy: XY) => {\n\t\tconst node = grid.get(xy)\n\t\tif(isConcaveCorner(node)){\n\t\t\treturn true\n\t\t}\n\n\t\tif(node.bottomIsSolid || node.leftIsSolid || node.rightIsSolid){\n\t\t\treturn false\n\t\t}\n\n\t\tconst top = grid.getTopOf(xy)\n\t\tconst left = grid.getBottomLeftOf(xy)\n\t\tconst right = grid.getBottomRightOf(xy)\n\n\t\tconst topIsSolid = !grid.isCoordValid(top) || grid.get(top).bottomIsSolid\n\t\tconst leftIsSolid = !grid.isCoordValid(left) || grid.get(left).rightIsSolid\n\t\tconst rightIsSolid = !grid.isCoordValid(right) || grid.get(right).leftIsSolid\n\n\t\treturn topIsSolid && leftIsSolid && rightIsSolid\n\t}\n\tconst getFlipped = (node: TriangleGridRhombusNode): TriangleGridRhombusNode => {\n\t\tif(isConcaveCorner(node)){\n\t\t\treturn {leftIsSolid: false, rightIsSolid: false, bottomIsSolid: false}\n\t\t}\n\t\treturn {leftIsSolid: true, rightIsSolid: true, bottomIsSolid: true}\n\t}\n\tconst tryMutate = (xy: XY, mutator: (node: TriangleGridRhombusNode) => TriangleGridRhombusNode) => {\n\t\tif(grid.isCoordValid(xy)){\n\t\t\tgrid.set(xy, mutator(grid.get(xy)))\n\t\t}\n\t}\n\tconst flipAt = (xy: XY) => {\n\t\t// console.log(`Flipping ${xy.x}, ${xy.y}`)\n\t\tconst node = grid.get(xy)\n\t\ttryMutate(grid.getBottomLeftOf(xy), node => ({...node, rightIsSolid: !node.rightIsSolid}))\n\t\ttryMutate(grid.getBottomRightOf(xy), node => ({...node, leftIsSolid: !node.leftIsSolid}))\n\t\ttryMutate(grid.getTopOf(xy), node => ({...node, bottomIsSolid: !node.bottomIsSolid}))\n\t\tgrid.set(xy, getFlipped(node))\n\t\tupdateNeighbours(xy)\n\t}\n\n\tfor(let i = 0; i < flipLimit; i++){\n\t\tif(flippables.size === 0){\n\t\t\tconsole.log(\"no flip candidate????\")\n\t\t\tbreak\n\t\t}\n\n\t\tperformeter.enterBlock(\"copy set\")\n\t\tconst arr = [...flippables] // very unoptimized, but I don't want to think about it too much right now\n\t\tperformeter.exitEnterBlock(\"flip\")\n\t\tconst xy = decodeXY(arr[Math.floor(Math.random() * arr.length)]!)\n\t\tflipAt(xy)\n\t\tperformeter.exitBlock()\n\t}\n\n}","interface Block {\n\tparent: Block | null\n\tsubblocks: Record<string, Block>\n\ttimeStart: number\n\ttimeSum: number\n\tenterCount: number\n}\n\ninterface BlockToPrint {\n\t\"ms per enter\": number\n\t\"full %\": number\n\t\"parent %\": number\n}\n\nclass Perfometer {\n\n\tprivate root: Block = this.makeBlock(null)\n\tprivate currentBlock: Block = this.root\n\tprivate eventCounters: Record<string, number> = {}\n\n\tprivate makeBlock(parent: Block | null): Block {\n\t\treturn {\n\t\t\tsubblocks: {}, parent: parent,\n\t\t\ttimeStart: -1, timeSum: 0,\n\t\t\tenterCount: 0\n\t\t}\n\t}\n\n\tenterBlock(name: string): void {\n\t\tlet nextBlock = this.currentBlock.subblocks[name]\n\t\tif(!nextBlock){\n\t\t\tnextBlock = this.makeBlock(this.currentBlock)\n\t\t\tthis.currentBlock.subblocks[name] = nextBlock\n\t\t}\n\t\tnextBlock.timeStart = performance.now()\n\t\tnextBlock.enterCount++\n\t\tthis.currentBlock = nextBlock\n\t}\n\n\trecordEvent(name: string): void {\n\t\tthis.eventCounters[name] = (this.eventCounters[name] ?? 0) + 1\n\t}\n\n\texitBlock(): void {\n\t\tthis.currentBlock.timeSum += performance.now() - this.currentBlock.timeStart\n\t\tconst parent = this.currentBlock.parent\n\t\tif(!parent){\n\t\t\tthrow new Error(\"No parent! Blocks are all messed up.\")\n\t\t}\n\t\tthis.currentBlock = parent\n\t}\n\n\texitEnterBlock(name: string): void {\n\t\tthis.exitBlock()\n\t\tthis.enterBlock(name)\n\t}\n\n\tprint(): void {\n\t\tconst table: Record<string, BlockToPrint> = {}\n\t\tlet fullTime = 0\n\t\tfor(const name in this.root.subblocks){\n\t\t\tfullTime += this.root.subblocks[name]!.timeSum\n\t\t}\n\n\t\tthis.forEachBlock((block, name, depth) => {\n\t\t\tname = new Array(depth + 1).join(\"-\") + name\n\t\t\ttable[name] = {\n\t\t\t\t\"parent %\": strip((block.timeSum / block.parent!.timeSum) * 100),\n\t\t\t\t\"full %\": strip((block.timeSum / fullTime) * 100),\n\t\t\t\t\"ms per enter\": strip(block.timeSum / block.enterCount)\n\t\t\t}\n\t\t})\n\n\t\tconsole.table(table)\n\t\tconsole.table(this.eventCounters)\n\t}\n\n\treset(): void {\n\t\tthis.root = this.makeBlock(null)\n\t\tthis.currentBlock = this.root\n\t\tthis.eventCounters = {}\n\t}\n\n\tprivate forEachBlock(callback: (block: Block, name: string, depth: number) => void, start: Block = this.root, currentDepth = 0): void {\n\t\tfor(const name in start.subblocks){\n\t\t\tconst subblock = start.subblocks[name]!\n\t\t\tcallback(subblock, name, currentDepth)\n\t\t\tthis.forEachBlock(callback, subblock, currentDepth + 1)\n\t\t}\n\t}\n\n}\n\nexport const performeter = new Perfometer()\n\nfunction strip(v: number): number {\n\treturn Math.round(v * 100) / 100\n}","import {Queue} from \"common/queue\"\n\ninterface Props<T> {\n\treadonly length: number // left side distance\n\treadonly width: number // right side distance\n\treadonly height: number // top side distance\n\treadonly defaultValue: T\n}\n\nexport interface XY {\n\treadonly x: number\n\treadonly y: number\n}\n\nexport const encodeXY = (xy: XY): number => (xy.y << 0x10) | xy.x\nexport const decodeXY = (key: number): XY => ({x: key & 0xffff, y: (key >> 0x10)})\n\n/** A container for values arranged in triangle pattern.\n * Columns are aligned, each next row is offset by half.\n * Resulting pattern of values, if drawn on 2d plane, will generally look like 6-sided polygon (4-sided, if one of the dimensions is 1, etc)\n *\n * This class also contains utility related arithmetic functions.  */\nexport class TriangleGrid<T> {\n\n\t/** Amount of columns in the grid */\n\treadonly xWidth: number\n\t/** Difference of Y coord between lowest and highest point of grid, in cells.\n\t * May be fractional (because half-cell distance is possible in triangle grid). */\n\treadonly yHeight: number\n\t/** Count of elements in the grid. */\n\treadonly count: number\n\t/** X coord of column that has highest grid point */\n\treadonly topCornerColumnX: number\n\tprivate readonly values: T[][]\n\n\tconstructor(private readonly props: Props<T>) {\n\t\tif(props.width < 1 || props.height < 1 || props.length < 1 || props.width % 1 || props.height % 1 || props.length % 1){\n\t\t\tthrow new Error(`Incorrect grid dimensions: ${props.length} x ${props.width} x ${props.height}`)\n\t\t}\n\t\tthis.xWidth = props.length + props.width - 1\n\t\tthis.yHeight = (this.xWidth / 2) + props.height\n\t\tthis.topCornerColumnX = this.props.length - 1\n\t\tthis.count = TriangleGrid.getCount(this.props.length, this.props.width, this.props.height)\n\t\tthis.values = new Array(this.xWidth)\n\t\t\t.fill(null)\n\t\t\t.map((_, x) => new Array(this.getHeightOfColumnAt(x))\n\t\t\t\t.fill(null)\n\t\t\t\t.map(() => props.defaultValue)\n\t\t\t)\n\t}\n\n\tstatic getCount(length: number, width: number, height: number): number {\n\t\tlet result = 0\n\t\tconst xWidth = length + width - 1\n\t\tfor(let x = 0; x < xWidth; x++){\n\t\t\tresult += this.getHeightOfColumnAt(length, width, height, x)\n\t\t}\n\t\treturn result\n\t}\n\n\tstatic getHeightOfColumnAt(length: number, width: number, height: number, x: number): number {\n\t\tlet result = height\n\t\tif(x < length && x < width){\n\t\t\tresult += x\n\t\t} else if((x < length) !== (x < width)){\n\t\t\tresult += Math.min(length, width) - 1\n\t\t} else {\n\t\t\tresult += (length + width - 1) - 1 - x\n\t\t}\n\t\treturn result\n\t}\n\n\tgetHeightOfColumnAt(x: number): number {\n\t\treturn TriangleGrid.getHeightOfColumnAt(this.props.length, this.props.width, this.props.height, x)\n\t}\n\n\t* [Symbol.iterator](): IterableIterator<{x: number, y: number, value: T}> {\n\t\tfor(let x = 0; x < this.values.length; x++){\n\t\t\tconst col = this.values[x]!\n\t\t\tfor(let y = 0; y < col.length; y++){\n\t\t\t\tyield{x, y, value: col[y]!}\n\t\t\t}\n\t\t}\n\t}\n\n\t/** @returns difference between y coord of highest point of the whole rhombus and y coords the highest point in this column, in cells */\n\tgetVerticalOffset(x: number): number {\n\t\treturn Math.abs(this.topCornerColumnX - x) / 2\n\t}\n\n\tgetCenterCornerCoords(): XY {\n\t\treturn {\n\t\t\tx: this.topCornerColumnX,\n\t\t\ty: this.props.height - 1\n\t\t}\n\t}\n\n\tgetTopCornerCoords(): XY {\n\t\treturn {\n\t\t\tx: this.topCornerColumnX,\n\t\t\ty: 0\n\t\t}\n\t}\n\n\tgetLeftBottomCornerCoords(): XY {\n\t\treturn {\n\t\t\tx: 0,\n\t\t\ty: this.values[0]!.length - 1\n\t\t}\n\t}\n\n\tgetRightBottomCornerCoords(): XY {\n\t\treturn {\n\t\t\tx: this.values.length - 1,\n\t\t\ty: this.values[this.values.length - 1]!.length - 1\n\t\t}\n\t}\n\n\t/** @returns true if coords are within the grid */\n\tisCoordValid(coords: XY): boolean {\n\t\tif(coords.x < 0 || coords.y < 0){\n\t\t\treturn false\n\t\t}\n\t\tconst col = this.values[coords.x]\n\t\treturn !!col && col.length > coords.y\n\t}\n\n\tprivate throwOnInvalidCoords(coords: XY): void {\n\t\tif(!this.isCoordValid(coords)){\n\t\t\tthrow new Error(`Asked for value at ${coords.x}, ${coords.y}, but container only has ${this.values.length} columns, and this column ${this.values.length > coords.x ? `contains only ${this.values[coords.x]!.length} rows` : \"does not exist\"}.`)\n\t\t}\n\t}\n\n\tget(coords: XY): T {\n\t\tthis.throwOnInvalidCoords(coords)\n\t\treturn this.values[coords.x]![coords.y]!\n\t}\n\n\tset(coords: XY, value: T): void {\n\t\tthis.values[coords.x]![coords.y] = value\n\t}\n\n\t// this method, and others, are just for arithmetics\n\t// they can return a coord that is out of this grid\n\t// use areCoordsValid() to check if this is the case\n\tgetTopLeftOf({x, y}: XY): XY {\n\t\treturn {x: x - 1, y: x <= this.topCornerColumnX ? y - 1 : y}\n\t}\n\n\tgetBottomLeftOf({x, y}: XY): XY {\n\t\treturn {x: x - 1, y: x <= this.topCornerColumnX ? y : y + 1}\n\t}\n\n\tgetTopRightOf({x, y}: XY): XY {\n\t\treturn {x: x + 1, y: x < this.topCornerColumnX ? y : y - 1}\n\t}\n\n\tgetBottomRightOf({x, y}: XY): XY {\n\t\treturn {x: x + 1, y: x < this.topCornerColumnX ? y + 1 : y}\n\t}\n\n\tgetTopOf({x, y}: XY): XY {\n\t\treturn {x, y: y - 1}\n\t}\n\n\tgetBottomOf({x, y}: XY): XY {\n\t\treturn {x, y: y + 1}\n\t}\n\n\tgetValidNeighbourCoords(xy: XY): XY[] {\n\t\treturn [\n\t\t\tthis.getTopOf(xy),\n\t\t\tthis.getBottomOf(xy),\n\t\t\tthis.getTopLeftOf(xy),\n\t\t\tthis.getTopRightOf(xy),\n\t\t\tthis.getBottomLeftOf(xy),\n\t\t\tthis.getBottomRightOf(xy)\n\t\t].filter(xy => this.isCoordValid(xy))\n\t}\n\n\t/** Starting at startingPoint, get next points from explorer; explore while there are points to explore.\n\t * Each point is visited only once. */\n\texploreFrom(startingPoint: XY, explore: (xy: XY) => XY[]): void {\n\t\tconst queue = new Queue<XY>()\n\t\tconst processed = new Set<number>()\n\n\t\tlet next: XY | undefined = startingPoint\n\t\twhile(next){\n\t\t\tconst points = explore(next)\n\t\t\tfor(const xy of points){\n\t\t\t\tif(!this.isCoordValid(xy)){\n\t\t\t\t\tcontinue\n\t\t\t\t}\n\t\t\t\tconst key = encodeXY(xy)\n\t\t\t\tif(!processed.has(key)){\n\t\t\t\t\tprocessed.add(key)\n\t\t\t\t\tqueue.enqueue(xy)\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tnext = queue.maybeDequeue()\n\t\t}\n\t}\n\n}","interface Node<T> {\n\tprev?: Node<T>\n\tvalue: T\n}\n\nexport class Queue<T> {\n\n\tprivate len = 0\n\tprivate headNode?: Node<T>\n\tprivate tailNode?: Node<T>\n\n\tget length(): number {\n\t\treturn this.len\n\t}\n\n\tget head(): T | undefined {\n\t\treturn this.headNode?.value\n\t}\n\n\tget tail(): T | undefined {\n\t\treturn this.tailNode?.value\n\t}\n\n\tenqueue(value: T): void {\n\t\tif(this.headNode && this.tailNode){\n\t\t\tconst oldTail = this.tailNode\n\t\t\tthis.tailNode = {value}\n\t\t\toldTail.prev = this.tailNode\n\t\t} else {\n\t\t\tthis.headNode = this.tailNode = {value}\n\t\t}\n\t\tthis.len++\n\t}\n\n\tdequeue(): T {\n\t\tif(!this.headNode){\n\t\t\tthrow new Error(\"Queue empty, cannot dequeue.\")\n\t\t}\n\t\tconst result = this.headNode.value\n\t\tthis.headNode = this.headNode.prev\n\t\tthis.len--\n\t\treturn result\n\t}\n\n\tmaybeDequeue(): T | undefined {\n\t\tif(!this.headNode){\n\t\t\treturn undefined\n\t\t}\n\t\tconst result = this.headNode.value\n\t\tthis.headNode = this.headNode.prev\n\t\tthis.len--\n\t\treturn result\n\t}\n\n\tclear(): void {\n\t\tthis.len = 0\n\t\tthis.headNode = this.tailNode = undefined\n\t}\n\n\ttoArrayHeadFirst(): T[] {\n\t\tconst result: T[] = new Array(this.len)\n\t\tlet node = this.headNode\n\t\tlet i = 0\n\t\twhile(node){\n\t\t\tresult[i++] = node.value\n\t\t\tnode = node.prev\n\t\t}\n\t\treturn result\n\t}\n\n}","import wasm from \"sketches/random_rhombus_tilings/wasm/rhombus_randomiser.wasm\"\nimport {instantiate} from \"./wasm/rhombus_randomiser\"\n\nexport type WasmRhombusRandomiser = ReturnType<typeof instantiate> extends Promise<infer X>? X: never\n\nexport const getWasmRhombusRandomiser = async(): Promise<WasmRhombusRandomiser> => {\n\treturn await instantiate(fetch(wasm))\n}","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"d9iEL\")).toString();","\"use strict\";\n\nvar mapping = {};\n\nfunction register(pairs) {\n  var keys = Object.keys(pairs);\n\n  for (var i = 0; i < keys.length; i++) {\n    mapping[keys[i]] = pairs[keys[i]];\n  }\n}\n\nfunction resolve(id) {\n  var resolved = mapping[id];\n\n  if (resolved == null) {\n    throw new Error('Could not resolve bundle with id ' + id);\n  }\n\n  return resolved;\n}\n\nmodule.exports.register = register;\nmodule.exports.resolve = resolve;","export async function instantiate(module, imports = {}) {\n  const adaptedImports = {\n    env: Object.assign(Object.create(globalThis), imports.env || {}, {\n      abort(message, fileName, lineNumber, columnNumber) {\n        // ~lib/builtins/abort(~lib/string/String | null?, ~lib/string/String | null?, u32?, u32?) => void\n        message = __liftString(message >>> 0);\n        fileName = __liftString(fileName >>> 0);\n        lineNumber = lineNumber >>> 0;\n        columnNumber = columnNumber >>> 0;\n        (() => {\n          // @external.js\n          throw Error(`${message} in ${fileName}:${lineNumber}:${columnNumber}`);\n        })();\n      },\n      \"performance.now\"() {\n        // ~lib/bindings/dom/performance.now() => f64\n        return performance.now();\n      },\n      seed() {\n        // ~lib/builtins/seed() => f64\n        return (() => {\n          // @external.js\n          return Date.now() * Math.random();\n        })();\n      },\n    }),\n  };\n  const { exports } = (await WebAssembly.instantiateStreaming(module, adaptedImports)).instance;\n  const memory = exports.memory || imports.env.memory;\n  const adaptedExports = Object.setPrototypeOf({\n    randomizeRhombusPattern(arr, length, width, height, flipLimit) {\n      // rhombus_randomizer.as/randomizeRhombusPattern(~lib/typedarray/Uint8Array, i32, i32, i32, i32) => ~lib/typedarray/Uint8Array\n      arr = __lowerTypedArray(Uint8Array, 5, 0, arr) || __notnull();\n      return __liftTypedArray(Uint8Array, exports.randomizeRhombusPattern(arr, length, width, height, flipLimit) >>> 0);\n    },\n    getMetrics() {\n      // rhombus_randomizer.as/getMetrics() => ~lib/typedarray/Float64Array\n      return __liftTypedArray(Float64Array, exports.getMetrics() >>> 0);\n    },\n    getNeighbours(length, width, height, count, x, y) {\n      // rhombus_randomizer.as/getNeighbours(i32, i32, i32, i32, i32, i32) => ~lib/typedarray/Int32Array\n      return __liftTypedArray(Int32Array, exports.getNeighbours(length, width, height, count, x, y) >>> 0);\n    },\n  }, exports);\n  function __liftString(pointer) {\n    if (!pointer) return null;\n    const\n      end = pointer + new Uint32Array(memory.buffer)[pointer - 4 >>> 2] >>> 1,\n      memoryU16 = new Uint16Array(memory.buffer);\n    let\n      start = pointer >>> 1,\n      string = \"\";\n    while (end - start > 1024) string += String.fromCharCode(...memoryU16.subarray(start, start += 1024));\n    return string + String.fromCharCode(...memoryU16.subarray(start, end));\n  }\n  function __liftTypedArray(constructor, pointer) {\n    if (!pointer) return null;\n    return new constructor(\n      memory.buffer,\n      __getU32(pointer + 4),\n      __dataview.getUint32(pointer + 8, true) / constructor.BYTES_PER_ELEMENT\n    ).slice();\n  }\n  function __lowerTypedArray(constructor, id, align, values) {\n    if (values == null) return 0;\n    const\n      length = values.length,\n      buffer = exports.__pin(exports.__new(length << align, 1)) >>> 0,\n      header = exports.__new(12, id) >>> 0;\n    __setU32(header + 0, buffer);\n    __dataview.setUint32(header + 4, buffer, true);\n    __dataview.setUint32(header + 8, length << align, true);\n    new constructor(memory.buffer, buffer, length).set(values);\n    exports.__unpin(buffer);\n    return header;\n  }\n  function __notnull() {\n    throw TypeError(\"value must not be null\");\n  }\n  let __dataview = new DataView(memory.buffer);\n  function __setU32(pointer, value) {\n    try {\n      __dataview.setUint32(pointer, value, true);\n    } catch {\n      __dataview = new DataView(memory.buffer);\n      __dataview.setUint32(pointer, value, true);\n    }\n  }\n  function __getU32(pointer) {\n    try {\n      return __dataview.getUint32(pointer, true);\n    } catch {\n      __dataview = new DataView(memory.buffer);\n      return __dataview.getUint32(pointer, true);\n    }\n  }\n  return adaptedExports;\n}\n","import {tag} from \"@nartallax/cardboard-dom\"\nimport * as css from \"./bottom_bar.module.scss\"\n\ninterface Props {\n\tparent: HTMLElement\n\tcontents: HTMLElement[]\n}\n\n// this will return not the container itself, but the element you can add other stuff to\nexport const makeBottomBarredScreenContainer = (props: Props): HTMLElement => {\n\tconst bar = tag({class: css.bottomBar}, props.contents)\n\tconst contentContainer = tag({class: css.contentContainer})\n\tconst wrap = tag({class: css.pageContainer}, [contentContainer, bar])\n\n\tprops.parent.appendChild(wrap)\n\n\treturn contentContainer\n}","@import \"/src/website/style/vars\";\n\n.bottomBar {\n\tdisplay: flex;\n\tflex-direction: row;\n\tflex-wrap: wrap;\n\tflex: 0 0 auto;\n\tcolumn-gap: 2rem;\n\trow-gap: 0.5rem;\n\tpadding: 0.5rem;\n\talign-items: center;\n\tbackground-color: $foreground-secondary-color;\n\talign-self: stretch;\n}\n\n.pageContainer {\n\twidth: 100vw;\n\theight: 100vh;\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: stretch;\n}\n\n.contentContainer {\n\tflex: 1 1 0;\n}\n","import {box, constBoxWrap, isRBox, MRBox, WBox} from \"@nartallax/cardboard\"\nimport {bindBox, tag} from \"@nartallax/cardboard-dom\"\nimport {addCursorMoveHandler, pointerEventsToClientCoords} from \"common/input_utils\"\nimport * as css from \"./slider.module.scss\"\n\ninterface Props {\n\treadonly min: MRBox<number>\n\treadonly max: MRBox<number>\n\treadonly step?: number\n\treadonly value: WBox<number>\n\treadonly label?: MRBox<string>\n\treadonly labelWidth?: MRBox<number | string>\n}\n\nexport const Slider = (props: Props): HTMLElement => {\n\tconst min = constBoxWrap(props.min)\n\tconst max = constBoxWrap(props.max)\n\n\tconst handle = tag({class: css.handle})\n\tconst handleContainer = tag({class: css.handleContainer}, [handle])\n\tlet root = tag({class: css.slider}, [handleContainer])\n\tif(props.label){\n\t\tconst labelWidth = isRBox(props.labelWidth) ? props.labelWidth : box(props.labelWidth)\n\t\troot = tag({class: css.sliderRoot}, [\n\t\t\ttag({\n\t\t\t\tclass: css.label,\n\t\t\t\tstyle: {\n\t\t\t\t\twidth: labelWidth.map(x => typeof(x) === \"number\" ? x + \"px\" : x ?? \"\")\n\t\t\t\t}\n\t\t\t}, [props.label]),\n\t\t\troot\n\t\t])\n\t}\n\n\tfunction updateHandlePos(newValue: number): void {\n\t\thandle.style.left = (((newValue - min.get()) / (max.get() - min.get())) * 100) + \"%\"\n\t}\n\n\tfunction setValueByEvent(e: MouseEvent | TouchEvent): void {\n\t\tconst coords = pointerEventsToClientCoords(e)\n\t\tconst contRect = handleContainer.getBoundingClientRect()\n\n\t\tlet progress = (coords.x - contRect.left) / contRect.width\n\t\tprogress = Math.min(1, Math.max(0, progress))\n\t\tlet newValue = (progress * (max.get() - min.get())) + min.get()\n\t\tif(props.step){\n\t\t\tnewValue = Math.round(newValue / props.step) * props.step\n\t\t}\n\n\t\tprops.value.set(newValue)\n\t}\n\n\taddCursorMoveHandler({\n\t\telement: handle,\n\t\tonMove: setValueByEvent\n\t})\n\n\tconst onSliderBodyClick = (e: MouseEvent | TouchEvent) => {\n\t\tif(e.target === handle){\n\t\t\treturn\n\t\t}\n\n\t\tsetValueByEvent(e)\n\t}\n\n\troot.addEventListener(\"click\", onSliderBodyClick)\n\n\tbindBox(root, props.value, value => updateHandlePos(value))\n\tbindBox(root, max, max => {\n\t\tif(props.value.get() > max){\n\t\t\tprops.value.set(max)\n\t\t} else {\n\t\t\tupdateHandlePos(props.value.get())\n\t\t}\n\t})\n\tbindBox(root, min, min => {\n\t\tif(props.value.get() < min){\n\t\t\tprops.value.set(min)\n\t\t} else {\n\t\t\tupdateHandlePos(props.value.get())\n\t\t}\n\t})\n\n\treturn root\n}","export function pointerEventsToClientCoords(e: MouseEvent | TouchEvent): {x: number, y: number} {\n\tif(isTouchEvent(e)){\n\t\tconst touch = e.touches[0]!\n\t\treturn {\n\t\t\tx: touch.clientX,\n\t\t\ty: touch.clientY\n\t\t}\n\t} else {\n\t\treturn {\n\t\t\tx: e.clientX,\n\t\t\ty: e.clientY\n\t\t}\n\t}\n}\n\nexport function pointerEventsToOffsetCoords(e: MouseEvent | TouchEvent): {x: number, y: number} | null {\n\tif(!(e.target instanceof HTMLElement)){\n\t\treturn null\n\t}\n\n\tconst rect = e.target.getBoundingClientRect() // performance may suck, but whatever\n\tconst coords = pointerEventsToClientCoords(e)\n\tcoords.x -= rect.left\n\tcoords.y -= rect.top\n\treturn coords\n}\n\nexport function isTouchEvent(e: MouseEvent | TouchEvent): e is TouchEvent {\n\treturn !!(e as TouchEvent).touches\n}\n\ntype CursorMoveHandlerParams = {\n\treadonly element: HTMLElement\n\tonMove(e: MouseEvent | TouchEvent): void\n\t/** If true, onMove will be invoked when down event happen */\n\treadonly downIsMove?: boolean\n\t/** If true, onMove will be invoked when up event happen */\n\treadonly upIsMove?: boolean\n}\n\n/** This is a good way to add a mousemove handler to an element */\nexport function addCursorMoveHandler(params: CursorMoveHandlerParams): void {\n\n\tconst onDown = (e: MouseEvent | TouchEvent) => {\n\t\twindow.addEventListener(\"mousemove\", params.onMove, {passive: true})\n\t\twindow.addEventListener(\"touchmove\", params.onMove, {passive: true})\n\t\twindow.addEventListener(\"mouseup\", onUp, {passive: true})\n\t\twindow.addEventListener(\"touchend\", onUp, {passive: true})\n\t\tif(params.downIsMove){\n\t\t\tparams.onMove(e)\n\t\t}\n\t}\n\n\tconst onUp = (e: MouseEvent | TouchEvent) => {\n\t\twindow.removeEventListener(\"mousemove\", params.onMove)\n\t\twindow.removeEventListener(\"touchmove\", params.onMove)\n\t\twindow.removeEventListener(\"mouseup\", onUp)\n\t\twindow.removeEventListener(\"touchend\", onUp)\n\t\tif(params.upIsMove){\n\t\t\tparams.onMove(e)\n\t\t}\n\t}\n\n\tparams.element.addEventListener(\"mousedown\", onDown, {passive: true})\n\tparams.element.addEventListener(\"touchstart\", onDown, {passive: true})\n}\n\nexport function preventContextMenu(el: HTMLElement): void {\n\tel.addEventListener(\"contextmenu\", e => {\n\t\te.preventDefault()\n\t\te.stopPropagation()\n\t\treturn false\n\t})\n}","@import \"/src/website/style/vars\";\n\n.sliderRoot {\n\tdisplay: flex;\n\tflex-direction: row;\n\talign-items: stretch;\n\tgap: 0.5rem;\n}\n\n.slider {\n\tbackground-color: $background-color;\n\tborder: 3px solid $font-color;\n\tborder-radius: 3px;\n\toverflow: hidden;\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: stretch;\n}\n\n.handleContainer {\n\tflex: 1 1 auto;\n\tposition: relative;\n\theight: 100%;\n\tmargin: 0 0.5em;\n\tmin-width: 15rem;\n\tmin-height: 1.25em;\n}\n\n.handle {\n\tbox-sizing: border-box;\n\twidth: 1rem;\n\tcursor: pointer;\n\tborder: 3px solid $font-color;\n\tborder-top-width: 0;\n\tborder-bottom-width: 0;\n\tbackground-color: $font-color;\n\tposition: absolute;\n\ttop: 0;\n\tbottom: 0;\n\ttransform: translateX(-50%);\n}\n\n.label {\n\toverflow: hidden;\n\tflex: 0 0 auto;\n\tcolor: $font-color;\n\ttext-align: right;\n}","export function debounce(time: number | \"raf\", handler: () => void): () => void {\n\tlet timer: ReturnType<typeof setTimeout> | ReturnType<typeof requestAnimationFrame> | null = null\n\n\treturn () => {\n\t\tif(timer){\n\t\t\treturn\n\t\t}\n\n\t\tif(time === \"raf\"){\n\t\t\ttimer = requestAnimationFrame(() => {\n\t\t\t\ttimer = null\n\t\t\t\thandler()\n\t\t\t})\n\t\t} else {\n\t\t\ttimer = setTimeout(() => {\n\t\t\t\ttimer = null\n\t\t\t\thandler()\n\t\t\t}, time)\n\t\t}\n\t}\n}"],"names":["$elQpM","parcelRequire","$feb87bdc332a04e8$var$colors","$feb87bdc332a04e8$var$defaultDims","$feb87bdc332a04e8$var$defaultSteps","Math","floor","$6fuK6","TriangleGrid","getCount","$feb87bdc332a04e8$var$defaultSeed","random","async","$feb87bdc332a04e8$export$f22da7240b7add18","container","isPreview","randomizer","$kxLP6","getWasmRhombusRandomiser","redraw","$feb87bdc332a04e8$var$makeUpdater","root","debouncedRedraw","$euaFP","debounce","props","steps","$9H5KT","box","maxSteps","get","color","length","seed","height","width","$kTeo1","makeBottomBarredScreenContainer","parent","contents","$7sHgZ","tag","style","display","flexDirection","justifyContent","gap","$jmBhk","Slider","value","step","min","max","label","$feb87bdc332a04e8$var$labelWidth","onClick","set","$feb87bdc332a04e8$var$maxDim","$feb87bdc332a04e8$var$bottomBar","update","bindBox","getRoot","seedRandom","$8HcCf","performeter","enterBlock","dims","console","log","grid","$kFpLY","getEmptyRhombusPattern","exitEnterBlock","bytes","randomizeRhombusPattern","rhombusGridToBytes","rhombusGridFromBytes","innerHTML","rootRect","getBoundingClientRect","rootHeight","$feb87bdc332a04e8$var$margins","rootWidth","heightCellSize","yHeight","widthCellSize","xWidth","cellSize","svg","renderRhombuses","horisontalColor","$efatB","transformColorHsl","h","s","l","leftColor","rightColor","x","y","margin","appendChild","exitBlock","print","getMetrics","$fbf140c75cf60424$export$61227af714afdbe3","svgTag","setAttribute","strokeWidth","makePathMaker","name","expr","offset","getVerticalOffset","attrs","d","fill","rgbNumberToColorString","stroke","makeLeft","makeRight","makeBottom","leftIsSolid","rightIsSolid","bottomIsSolid","exploreFrom","getTopCornerCoords","xy","getBottomLeftOf","getBottomRightOf","getRightBottomCornerCoords","getTopOf","topCornerColumnX","getLeftBottomCornerCoords","$fa4a5aa5cdd6ce8e$var$twoHex","toString","$fa4a5aa5cdd6ce8e$export$fdc9c29511f1a926","$fa4a5aa5cdd6ce8e$export$79db3ad3d560d193","components","r","g","b","$fa4a5aa5cdd6ce8e$var$hueToRgb","p","q","t","$fa4a5aa5cdd6ce8e$export$c5ea230d2f55d434","rgb","$fa4a5aa5cdd6ce8e$export$21d90289cdbe307c","colorRgb","transform","transformResult","cmin","cmax","delta","round","abs","toFixed","$fa4a5aa5cdd6ce8e$export$c85ca4f4753af384","hsl","$fa4a5aa5cdd6ce8e$export$29fb7152bd3f781a","$625d88d1d12e65ae$export$f5bbc667addc1649","result","Uint8Array","count","colStarts","$625d88d1d12e65ae$var$calcColStarts","$625d88d1d12e65ae$export$a2bb0ff498b7a243","defaultValue","byte","Array","getHeightOfColumnAt","$625d88d1d12e65ae$export$594265a16ba9ecb7","center","getCenterCornerCoords","getBottomOf","getTopLeftOf","getTopRightOf","$6f792b9b35387246$export$e1ee22bc4cc102ea","this","makeBlock","currentBlock","eventCounters","subblocks","timeStart","timeSum","enterCount","nextBlock","performance","now","recordEvent","Error","table","fullTime","forEachBlock","block","depth","join","$6f792b9b35387246$var$strip","reset","callback","start","currentDepth","subblock","v","$6A5Hp","$420e0860c859833c$export$7f5a1f6765a2b466","$420e0860c859833c$export$5fdd4d96ea786aae","key","$420e0860c859833c$export$f83afd22d38be4aa","constructor","values","map","_","static","Symbol","iterator","col","isCoordValid","coords","throwOnInvalidCoords","getValidNeighbourCoords","filter","startingPoint","explore","queue","Queue","processed","Set","next","points","has","add","enqueue","maybeDequeue","$d86dd992f2068262$export$3dc07afe418952bc","len","head","headNode","tail","tailNode","oldTail","prev","dequeue","clear","undefined","toArrayHeadFirst","node","i","$9qvFf","$ac3684afa04ca243$export$bd88742c9a5aa178","$je7up","instantiate","fetch","$parcel$interopDefault","module","exports","URL","resolve","import","meta","url","$18c11f3350a906ea$export$6503ec6e8aabbaf","$18c11f3350a906ea$export$f7ad0328861e2f03","$18c11f3350a906ea$var$mapping","pairs","keys","Object","id","resolved","$dff52266ebfa9e35$export$f9bb8d20ccc7477a","imports","adaptedImports","env","assign","create","globalThis","abort","message","fileName","lineNumber","columnNumber","__liftString","Date","WebAssembly","instantiateStreaming","instance","memory","adaptedExports","setPrototypeOf","arr","flipLimit","align","buffer","__pin","__new","header","pointer","__dataview","setUint32","DataView","__setU32","__unpin","__lowerTypedArray","TypeError","__notnull","__liftTypedArray","Float64Array","getNeighbours","Int32Array","end","Uint32Array","memoryU16","Uint16Array","string","String","fromCharCode","subarray","getUint32","__getU32","BYTES_PER_ELEMENT","slice","$0b128bc07ced54fa$export$efc4f4afff32aea8","bar","class","$3MmRR","bottomBar","contentContainer","wrap","pageContainer","$2c0797ddc08f9f2b$export$eebe73d6e99d9049","$2c0797ddc08f9f2b$export$9bfd64464b8f45a7","$2c0797ddc08f9f2b$export$8f981dffec84ba52","$1bf0a92f5a0d7095$export$472062a354075cee","constBoxWrap","handle","$3KaNR","handleContainer","slider","labelWidth","isRBox","sliderRoot","updateHandlePos","newValue","left","setValueByEvent","e","$ih12A","pointerEventsToClientCoords","contRect","progress","addCursorMoveHandler","element","onMove","addEventListener","target","$070b40bf88f7afea$export$f9e1fc62131d1b82","touches","$070b40bf88f7afea$export$c4dfce035d43d1e0","touch","clientX","clientY","$070b40bf88f7afea$export$4eb1c1f17f883a41","HTMLElement","rect","top","$070b40bf88f7afea$export$80eb02ad18c977f1","params","onDown","window","passive","onUp","downIsMove","removeEventListener","upIsMove","$070b40bf88f7afea$export$b3002a74c1b9a5fd","el","preventDefault","stopPropagation","$2b9e0c477a19ae15$export$b38bf4f33e9e4c25","$2b9e0c477a19ae15$export$8f34ce051745d39e","$2b9e0c477a19ae15$export$c19509281e5dc3a3","$2b9e0c477a19ae15$export$1237798dc640739a","$2b9e0c477a19ae15$export$8240c6390807f912","$1fa5674b28854650$export$61fc7d43ac8f84b0","time","handler","timer","requestAnimationFrame","setTimeout"],"version":3,"file":"random_rhombus_tilings.6730e67d.js.map"}