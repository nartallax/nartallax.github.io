{"mappings":"kUAAA,IAAAA,EAAAC,EAAA,S,iEAOA,MAAMC,EAAyC,CAC9CC,4BAA6B,EAC7BC,OAAQ,GACRC,MAAO,GACPC,YAAa,IACbC,KAAM,QAGAC,eAAeC,EAAKC,GAC1B,MAAMC,GAAM,EAAAX,EAAAY,MAAI,EAAAC,EAAAC,oBAAmBZ,IAE7Ba,GAAW,EAAAC,EAAAC,qBAAoBf,GAAiBa,IACrDJ,EAAIO,KAAI,EAAAL,EAAAC,oBAAmBC,GAAA,IAG5BL,EAAKS,aAAY,EAAAC,EAAAC,KAAI,CAACC,MAAOC,EAAAb,MAAW,CACvCK,EACAJ,EAAIA,KAAIA,IAAO,EAAAa,EAAAC,kBAAiBd,OAElC,C,gFC1BA,IAAAe,EAAAzB,EAAA,S,aAgBA,IAAI0B,EAAuB,IAAM,EAI1B,MAAMC,EAAsBb,IAClC,MAAMc,EAAW,IAAI,EAAAH,EAAAI,kBAAiBf,EAASV,MAAOU,EAASX,QAC/DuB,GAAS,EAAAI,EAAAC,qBAAoBjB,EAASR,MAItC,MAAO,C,SACNQ,E,SAAUc,EAAUI,MAHPC,EAAcL,EAAUd,GAItC,EAKKmB,EAAgB,CAACL,EAA4Bd,KAClD,IAAIoB,EAAY,EAChB,MAAMC,EAA0B,GAC1BC,EAAkBtB,EAAST,YAAcS,EAASV,MAAQU,EAASX,OACzE,KAAM+B,EAAYE,GAAgB,CACjC,MAAMC,EAAaC,EAAoBV,EAAUd,GAC3CyB,EAAYH,EAAkBF,EACpC,GAAGK,EAAaC,GAEf,MAGD,IAAIC,EACJ,GAAGf,IAAW,GAAI,CAEjB,IAAIgB,EAASC,EAAoBf,EAAUS,EAAYvB,GACvD,GAAG4B,EAlBgB,EAmBlB,SAGDA,EAASE,KAAKC,KAAKH,GAAU,GAAkB,GAAXhB,MACpC,MAAMoB,EAAcF,KAAKG,MAAMH,KAAKI,KAAKT,EAAYK,KAAKK,KAC1DP,EAASE,KAAKM,IAAIJ,EAAaJ,GAE/BD,EAAcU,EAAWvB,EAAUS,EAAYK,GAC/CR,GAAaO,EAAYW,MAC1B,KAAO,CAEN,MAAMC,EAAOC,EAA2B1B,EAAUS,EAAYvB,GAC9D,GAAGuC,EAAKE,EA/BW,GA+BUF,EAAKG,EA/Bf,EAgClB,SAGDH,EAAKE,EAAIX,KAAKC,KAAKQ,EAAKE,GAAK,GAAkB,GAAX7B,MACpC2B,EAAKG,EAAIZ,KAAKC,KAAKQ,EAAKG,GAAK,GAAkB,GAAX9B,MACpC,MAAM+B,EAAalB,GAAac,EAAKE,EAAIF,EAAKG,EAAI,GAC/CC,EAAa,IACfJ,EAAKE,GAAKE,EACVJ,EAAKG,GAAKC,GAEXJ,EAAKE,EAAIX,KAAKc,IAAIL,EAAKE,EA1CJ,GA2CnBF,EAAKG,EAAIZ,KAAKc,IAAIL,EAAKG,EA3CJ,GA6CnBf,EAAckB,EAAc/B,EAAUS,EAAYgB,GAClDnB,GAAaO,EAAYW,MAC1B,CAEAjB,EAAMyB,KAAK,CAACC,KAAM,OAAQC,OAAQrB,GACnC,CAEA,OADAsB,QAAQC,IAAI,uCAAuC9B,GAAapB,EAASV,MAAQU,EAASX,SAAS8D,QAAQ,MACpG9B,CAAA,EAGFG,EAAsB,CAAC5B,EAAuBI,KACnD,OAAW,CACV,MAAMyC,EAAIX,KAAKG,MAAMrB,IAAWZ,EAASV,OACnCoD,EAAIZ,KAAKG,MAAMrB,IAAWZ,EAASX,QACzC,IAAIO,EAAIwD,IAAIX,EAAGC,GACd,MAAO,C,EAACD,E,EAAGC,EAEb,GAMKF,EAA6B,CAAC5C,EAAuByD,EAAYrD,KACtE,IAAIsD,EAAY,EACZC,EAAa,EACbC,GAAe,EACfC,GAAgB,EACpB,KAAMD,GAAgBC,GAAc,CACnC,MAAMC,GAAmBF,KAAuBC,GAAwB7C,IAAW,GACnF,GAAG8C,EAAgB,CAClB,GAAGL,EAAOX,EAAIa,EAAa,GAAKvD,EAASX,QAAUgE,EAAOX,GAAKa,EAAa,GAAK,EAAE,CAClFE,GAAgB,EAChB,QACD,CACAF,GACD,KAAO,CACN,GAAGF,EAAOZ,EAAIa,EAAY,GAAKtD,EAASV,OAAS+D,EAAOZ,GAAKa,EAAY,GAAK,EAAE,CAC/EE,GAAe,EACf,QACD,CACAF,GACD,CAEA,IAAIK,GAAkB,EAEtB,CACC,MAAMC,EAAOP,EAAOX,EAAIa,EAClBM,EAAOR,EAAOX,EAAIa,EACxB,IAAI,IAAIO,GAAMR,EAAWQ,GAAMR,EAAWQ,IAAK,CAC9C,MAAMrB,EAAIY,EAAOZ,EAAIqB,EACrB,GAAGlE,EAAIwD,IAAIX,EAAGmB,IAAShE,EAAIwD,IAAIX,EAAGoB,GAAM,CACvCF,GAAkB,EAClB,KACD,CACD,CACD,CAEA,IAAIA,EAAgB,CACnB,MAAMI,EAAOV,EAAOZ,EAAIa,EAClBU,EAAOX,EAAOX,EAAIY,EACxB,IAAI,IAAIW,GAAMV,EAAYU,GAAMV,EAAYU,IAAK,CAChD,MAAMvB,EAAIW,EAAOX,EAAIuB,EACrB,GAAGrE,EAAIwD,IAAIW,EAAMrB,IAAM9C,EAAIwD,IAAIY,EAAMtB,GAAG,CACvCiB,GAAkB,EAClB,KACD,CACD,CACD,CAEGA,IACCD,GACFH,IACAE,GAAgB,IAEhBH,IACAE,GAAe,GAIlB,CAEA,MAAO,CAACf,EAAGa,EAAWZ,EAAGa,EAAU,EAG9B1B,EAAsB,CAACjC,EAAuByD,EAAYrD,KAC/D,IAAI4B,EAAS,EACb,OAAW,CACV,GAAGyB,EAAOZ,EAAIb,EAAS,GAAK5B,EAASV,OAClC+D,EAAOZ,GAAKb,EAAS,GAAK,GAC1ByB,EAAOX,EAAId,EAAS,GAAK5B,EAASX,QAClCgE,EAAOX,GAAKd,EAAS,GAAK,EAC5B,OAAOA,EAERA,IACA,IAAI,IAAIkC,GAAMlC,EAAQkC,GAAMlC,EAAQkC,IAAK,CACxC,MAAMG,EAAKnC,KAAKI,KAAKN,EAAUA,EAAWkC,EAAKA,GACzCF,EAAO9B,KAAKG,MAAMoB,EAAOX,EAAIuB,GAC7BJ,EAAO/B,KAAKC,KAAKsB,EAAOX,EAAIuB,GAC5BxB,EAAIY,EAAOZ,EAAIqB,EACrB,GAAGlE,EAAIwD,IAAIX,EAAGmB,IAAShE,EAAIwD,IAAIX,EAAGoB,GACjC,OAAOjC,EAAS,CAElB,CACD,GAGKS,EAAa,CAACzC,EAAuByD,EAAYzB,KACtD,MAAMsC,EAAe,GACrB,IAAI,IAAIJ,GAAMlC,EAAQkC,GAAMlC,EAAQkC,IAAK,CACxC,MAAMG,EAAKnC,KAAKI,KAAKN,EAAUA,EAAWkC,EAAKA,GACzCF,EAAO9B,KAAKG,MAAMoB,EAAOX,EAAIuB,GAC7BJ,EAAO/B,KAAKC,KAAKsB,EAAOX,EAAIuB,GAC5BxB,EAAIY,EAAOZ,EAAIqB,EACrB,IAAI,IAAIpB,EAAIkB,EAAMlB,GAAKmB,EAAMnB,IAC5B9C,EAAIO,IAAIsC,EAAGC,GACXwB,EAAOpB,KAAK,C,EAACL,E,EAAGC,GAElB,CACA,OAAOwB,CAAA,EAGFrB,EAAgB,CAACjD,EAAuByD,EAAYd,KACzD,MAAM2B,EAAe,GACrB,IAAI,IAAIzB,EAAIY,EAAOZ,EAAIF,EAAKE,EAAGA,GAAKY,EAAOZ,EAAIF,EAAKE,EAAGA,IACtD,IAAI,IAAIC,EAAIW,EAAOX,EAAIH,EAAKG,EAAGA,GAAKW,EAAOX,EAAIH,EAAKG,EAAGA,IACtD9C,EAAIO,IAAIsC,EAAGC,GACXwB,EAAOpB,KAAK,C,EAACL,E,EAAGC,IAGlB,OAAOwB,CAAA,C,8EC1MR,MAAaC,EAQZC,YAAYC,EAAe,GAAIC,EAAgB,IAC9CC,KAAKC,SAAW1C,KAAKC,KAAKD,KAAK2C,KAAK3C,KAAKc,IAAI,EAAGd,KAAKC,KAAKsC,MAC1DE,KAAKG,UAAY5C,KAAKC,KAAKD,KAAK2C,KAAK3C,KAAKc,IAAI,EAAGd,KAAKC,KAAKuC,MAC3DC,KAAKjF,MAAQ,GAAKiF,KAAKC,SACvBD,KAAKlF,OAAS,GAAKkF,KAAKG,UACxBH,KAAKI,KAAO,IAAIC,WAAWL,KAAMjF,MAAQiF,KAAKlF,QAAW,EAC1D,CAGIwF,kBACH,OAAON,KAAKjF,KACb,CAEIwF,mBACH,OAAOP,KAAKlF,MACb,CAEA+D,IAAIX,EAAWC,GACd,GAAGD,GAAK8B,KAAKjF,OAASoD,GAAK6B,KAAKlF,OAC/B,OAAO,EAER,MAAM0F,GAAcrC,GAAK6B,KAAKC,UAAY/B,GAAM,EAEhD,SADa8B,KAAKI,KAAKI,GACL,IAAU,EAAJtC,GACzB,CAEAtC,IAAIsC,EAAWC,GACXD,GAAK8B,KAAKjF,OACZiF,KAAKS,UAAUT,KAAKU,UAAUxC,EAAG8B,KAAKjF,QAGpCoD,GAAK6B,KAAKlF,QACZkF,KAAKW,WAAWX,KAAKU,UAAUvC,EAAG6B,KAAKlF,SAGxC,MAAM0F,GAAcrC,GAAK6B,KAAKC,UAAY/B,GAAM,EAChD8B,KAAKI,KAAKI,IAAc,IAAU,EAAJtC,EAC/B,CAEA0C,MAAM1C,EAAWC,GACbD,GAAK8B,KAAKjF,OACZiF,KAAKS,UAAUT,KAAKU,UAAUxC,EAAG8B,KAAKjF,QAGpCoD,GAAK6B,KAAKlF,QACZkF,KAAKW,WAAWX,KAAKU,UAAUvC,EAAG6B,KAAKlF,SAGxC,MAAM0F,GAAcrC,GAAK6B,KAAKC,UAAY/B,GAAM,EAChD8B,KAAKI,KAAKI,MAAgB,IAAU,EAAJtC,GACjC,CAEA2C,QAAQC,EAAYC,EAAYC,EAAiBC,GAChD,MAAMC,EAAOJ,EAAKE,EACfE,GAAQlB,KAAKjF,OACfiF,KAAKS,UAAUT,KAAKU,UAAUQ,EAAMlB,KAAKjF,QAG1C,MAAMoG,EAAOJ,EAAKE,EACfE,EAAOnB,KAAKlF,QACdkF,KAAKW,WAAWX,KAAKU,UAAUS,EAAMnB,KAAKlF,SAG3C,MAAMsG,EAAgBN,GAAM,EACtBO,EAAcH,GAAQ,EAE5B,IAAII,EAAY,OAAU,IAAW,EAALR,IAAa,GACzCS,GAAW,IAAa,EAAPL,IAAe,EACjCE,IAAkBC,IACpBC,GAAaC,EACbA,EAAUD,GAGX,IAAI,IAAInD,EAAI4C,EAAI5C,EAAIgD,EAAMhD,IAAI,CAC7B,IAAIqD,EAAOF,EACX,MAAMG,EAAYV,GAAMf,KAAKC,SAC7B,IAAI,IAAIyB,EAAWN,EAAeM,EAAWL,EAAaK,IAAW,CACpE,MAAMC,EAAO3B,KAAKI,KAAKsB,EAAWD,GAClCzB,KAAKI,KAAKsB,EAAWD,GAAaE,EAAOH,EACzCA,EAAO,GACR,CACA,MAAMI,EAAO5B,KAAKI,KAAKiB,EAAcI,GACrCzB,KAAKI,KAAKiB,EAAcI,GAAaG,EAAOL,CAC7C,CACD,CAEAM,aAAaf,EAAYC,EAAYC,EAAiBC,GACrD,MAAMC,EAAO3D,KAAKM,IAAIiD,EAAKE,EAAShB,KAAKjF,OACnCoG,EAAO5D,KAAKM,IAAIkD,EAAKE,EAASjB,KAAKlF,QAEnCsG,EAAgBN,GAAM,EACtBO,EAAcH,GAAQ,EAE5B,IAAII,EAAY,OAAU,IAAW,EAALR,IAAa,GACzCS,GAAW,IAAa,EAAPL,IAAe,EACjCE,IAAkBC,IACpBC,GAAaC,EACbA,EAAUD,GAMX,IAAI,IAAInD,EAAI4C,EAAI5C,EAAIgD,EAAMhD,IAAI,CAC7B,IAAIqD,EAAOF,EACX,MAAMG,EAAYV,GAAMf,KAAKC,SAC7B,IAAI,IAAIyB,EAAWN,EAAeM,EAAWL,EAAaK,IAAW,CAEpE,GADa1B,KAAKI,KAAKsB,EAAWD,GACxBD,EACT,OAAO,EAERA,EAAO,GACR,CAGA,GAFaxB,KAAKI,KAAKiB,EAAcI,GAE3BF,EACT,OAAO,CAET,CAEA,OAAO,CACR,CAEQb,UAAUoB,EAAsBC,GACvC,IAAIC,EAAc,EAClB,KAAMF,EAAgBC,GAAeC,GACpCA,IAED,OAAOA,CACR,CAEQvB,UAAUwB,GAGjB,MAAMC,EAAWlC,KAAKjF,OAASkH,EACzBE,EAAcnC,KAAKC,SAAWgC,EAC9BG,EAAS,IAAI/B,WAAWL,KAAMlF,QAAUkF,KAAKjF,OAASkH,IAAW,GACvE,IAAI,IAAI9D,EAAI,EAAGA,EAAI6B,KAAKlF,OAAQqD,IAC/B,IAAI,IAAID,EAAI,EAAGA,EAAI8B,KAAKjF,MAAOmD,IAAI,CAClC,MAAMmE,GAAiBlE,GAAK6B,KAAKC,UAAY/B,GAAM,EAEnDkE,GADuBjE,GAAKgE,GAAejE,GAAM,GAC1B8B,KAAKI,KAAKiC,EAClC,CAEDrC,KAAKI,KAAOgC,EACZpC,KAAKC,SAAWkC,EAChBnC,KAAKjF,MAAQmH,CACd,CAEQvB,WAAWsB,GAClB,MAAMK,EAAMtC,KAAKI,KAAKrC,OACtBiC,KAAKlF,SAAWmH,EAChBjC,KAAKG,WAAa8B,EAClB,MAAMG,EAAS,IAAI/B,WAAWL,KAAMjF,MAAQiF,KAAKlF,QAAW,GAC5D,IAAI,IAAIyH,EAAI,EAAGA,EAAID,EAAKC,IACvBH,EAAOG,GAAKvC,KAAKI,KAAKmC,GAEvBvC,KAAKI,KAAOgC,CACb,CAEAI,WACC,IAAI7C,EAAS,GACb,IAAI,IAAIxB,EAAI,EAAGA,EAAI6B,KAAKlF,OAAQqD,IAAI,CACnC,IAAI,IAAID,EAAI,EAAGA,EAAI8B,KAAKjF,MAAOmD,IAC9ByB,GAAUK,KAAKnB,IAAIX,EAAGC,GAAK,KAAO,KAEhCA,IAAM6B,KAAKlF,OAAS,IACtB6E,GAAU,KAEZ,CACA,OAAOA,CACR,CAEA8C,QAAQC,GAEP,MAAM/C,EAAS,IAAIC,EAAiBI,KAAKjF,MAAQ2H,EAAQ1C,KAAKlF,OAAS4H,GACvE,IAAI,IAAIxE,EAAI,EAAGA,EAAI8B,KAAKjF,MAAOmD,IAC9B,IAAI,IAAIC,EAAI,EAAGA,EAAI6B,KAAKlF,OAAQqD,IAC/B,GAAG6B,KAAKnB,IAAIX,EAAGC,GAAG,CACjB,MAAMwE,EAASzE,EAAIwE,EACbE,EAASzE,EAAIuE,EACnB,IAAI,IAAInD,EAAK,EAAGA,EAAKmD,EAAQnD,IAC5B,IAAI,IAAIG,EAAK,EAAGA,EAAKgD,EAAQhD,IAC5BC,EAAO/D,IAAI+G,EAASpD,EAAIqD,EAASlD,EAGpC,CAGF,OAAOC,CACR,E,iFC1MM,MAAMkD,EAAuB5H,IACnC,MAAM6H,EAAI,GAAK,GAAK,GAEpB,IAAIC,EAAI9H,EAAO6H,EACf,MAAO,KAAOC,EAFJ,OAEQA,EAAUD,GAAKA,CAAA,C,iFCJlC,IAAAhH,EAAAnB,EAAA,S,aAcO,MAAMqI,EAAsB,CAACC,EAAwCC,KAC3E,IAAIzH,EAAW,IAAIwH,GACnB,OAAO,EAAAnH,EAAAC,KAAI,CAACC,MAAOC,EAAAkH,cAAmB,CACrCC,EAAU,CACTC,MAAO,OACPxF,IAAKyF,OAAOC,iBACZlF,IAAKiF,OAAOE,iBACZC,aAAcR,EAAgBhI,KAC9BiI,SAAUjI,GAAQiI,EAASzH,EAAW,IAAIA,E,KAAUR,IACpDyI,YAAa,CACZC,KAAM,OACNC,QAASC,GAASA,EAAMC,MAASvG,KAAKG,MAAsB,WAAhBH,KAAKwG,UAAyB,MAG5EX,EAAU,CACTC,MAAO,QACPxF,IAAK,EACLQ,IAAK,IACLoF,aAAcR,EAAgBlI,MAC9BmI,SAAUnI,GAASmI,EAASzH,EAAW,IAAIA,E,MAAUV,IACrDiJ,WAAY,CAACL,KAAM,IAAKC,QAAS,CAACC,EAAOC,IAAUD,EAAMC,MAAQA,EAAS,EAAK,IAC/EJ,YAAa,CAACC,KAAM,IAAKC,QAAS,CAACC,EAAOC,IAAUD,EAAMC,MAAQA,EAAS,EAAK,MAEjFV,EAAU,CACTC,MAAO,SACPxF,IAAK,EACLQ,IAAK,IACLoF,aAAcR,EAAgBnI,OAC9BoI,SAAUpI,GAAUoI,EAASzH,EAAW,IAAIA,E,OAAUX,IACtDkJ,WAAY,CAACL,KAAM,IAAKC,QAAS,CAACC,EAAOC,IAAUD,EAAMC,MAAQA,EAAS,EAAK,IAC/EJ,YAAa,CAACC,KAAM,IAAKC,QAAS,CAACC,EAAOC,IAAUD,EAAMC,MAAQA,EAAS,EAAK,MAEjFV,EAAU,CACTC,MAAO,UACPxF,IAAK,IACLQ,IAAK,IACLoF,aAAcR,EAAgBjI,YAC9BkI,SAAUlI,GAAekI,EAASzH,EAAW,IAAIA,E,YAAUT,IAC3DgJ,WAAY,CAACL,KAAM,IAAKC,QAAS,CAACC,EAAOC,IAAUD,EAAMC,MAAQA,EAAS,IAAQ,IAClFJ,YAAa,CAACC,KAAM,IAAKC,QAAS,CAACC,EAAOC,IAAUD,EAAMC,MAAQA,EAAS,IAAQ,MAEpFV,EAAU,CACTC,MAAO,cACPxF,IAAK,EACLQ,IAAK,EACLoF,aAAcR,EAAgBpI,4BAC9BqI,SAAUrI,GAA+BqI,EAASzH,EAAW,IAAIA,E,4BAAUZ,IAC3EmJ,WAAY,CAACL,KAAM,IAAKC,QAAS,CAACC,EAAOC,IAAUD,EAAMC,MAAQA,EAAS,IAAQ,IAClFJ,YAAa,CAACC,KAAM,IAAKC,QAAS,CAACC,EAAOC,IAAUD,EAAMC,MAAQA,EAAS,IAAQ,OAEpF,EAeIV,EAAaa,IAClB,IAAIC,EAAiBD,EAAKR,aAE1B,MAAMU,EAAcF,GAA2CA,GAAc,EAAAnI,EAAAC,KAAI,CAChFA,IAAK,QACLqI,MAAO,CAAC5F,KAAM,SAAUsF,MAAOG,EAAKN,MACpCC,QAAS,KACRK,EAAKL,QAAQC,EAAOK,GACpBG,GAAY,EAAI,IALoD,KAShEA,EAAeC,IACpB,IAAIR,EAAQS,WAAWV,EAAMC,OAC1BA,IAAUI,IAIVZ,OAAOkB,MAAMV,KACfA,EAAQG,EAAKR,cAEXK,EAAQG,EAAKpG,MACfiG,EAAQG,EAAKpG,KAEXiG,EAAQG,EAAK5F,MACfyF,EAAQG,EAAK5F,KAEXyF,IAAUI,GAAkBI,IAC9BT,EAAMC,MAAQA,EAAQ,IAEvBI,EAAiBJ,EACjBG,EAAKf,SAASY,GAAA,EAGTD,GAAQ,EAAA/H,EAAAC,KAAI,CACjBA,IAAK,QACLqI,MAAO,CACN5F,KAAM,QAEPiG,OAAQ,IAAMJ,GAAY,GAC1BK,QAAS,IAAML,GAAY,GAC3BnB,SAAU,IAAMmB,GAAY,KAG7BR,EAAMC,MAAQI,EAAiB,GAC/B,MAAMF,EAAaG,EAAWF,EAAKD,YAC7BN,EAAcS,EAAWF,EAAKP,aASpC,OAPe,EAAA5H,EAAAC,KAAI,CAACC,MAAOC,EAAA0I,WAAgB,EAC1C,EAAA7I,EAAAC,KAAI,CAACC,MAAOC,EAAA2I,YAAiB,CAACX,EAAKZ,QACnCW,EACAH,EACAH,GAGM,C,sCCtIR,IAAAmB,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,E,mXARAR,EAAiC,sBACjCC,EAA8B,mBAC9BC,EAAiC,sBACjCC,EAA+B,oBAC/BC,EAA8B,mBAC9BC,EAA0B,eAC1BC,EAAyB,cACzBC,EAAyB,cACzBC,EAA8B,kB,8ECR9B,IAAApJ,EAAAtB,EAAA,S,aAIO,MAAM2K,EAAoBjK,IAChC,MAAMsE,GAAS,EAAA7D,EAAAC,KAAI,CAACC,MAAOC,EAAAsJ,eAC3B,IAAI,IAAIrH,EAAI,EAAGA,EAAI7C,EAAII,SAASV,MAAOmD,IAAI,CAC1C,MAAMsH,GAAS,EAAA1J,EAAAC,KAAI,CAACC,MAAOC,EAAAwJ,YAC3B9F,EAAO9D,YAAY2J,GACnB,IAAI,IAAIrH,EAAI,EAAGA,EAAI9C,EAAII,SAASX,OAAQqD,IAAI,CAC3C,MAAMuH,GAAS,EAAA5J,EAAAC,KAAI,CAClBC,MAAO,CACNC,EAAA0J,UACAtK,EAAIkB,SAASsC,IAAIX,EAAGC,GAAKlC,EAAA2J,MAAY3J,EAAA4J,MACpCC,KAAK,OAERN,EAAO3J,YAAY6J,EACpB,CACD,CACA,OAAO/F,CAAA,C","sources":["src/sketches/dungeon_mapper/dungeon_mapper.ts","src/sketches/dungeon_mapper/dungeon_mapper_generator.ts","src/common/growable_2d_bitmap.ts","src/common/seeded_random.ts","src/sketches/dungeon_mapper/dungeon_mapper_settings.ts","src/sketches/dungeon_mapper/dungeon_mapper.module.scss","src/sketches/dungeon_mapper/dungeon_mapper_render.ts"],"sourcesContent":["import {box} from \"@nartallax/cardboard\"\nimport {generateDungeonMap} from \"sketches/dungeon_mapper/dungeon_mapper_generator\"\nimport {DungeonMapperSettings, makeSettingsControl} from \"sketches/dungeon_mapper/dungeon_mapper_settings\"\nimport * as css from \"./dungeon_mapper.module.scss\"\nimport {tag} from \"@nartallax/cardboard-dom\"\nimport {renderDungeonMap} from \"sketches/dungeon_mapper/dungeon_mapper_render\"\n\nconst defaultSettings: DungeonMapperSettings = {\n\taverageRoomConnectionsCount: 2,\n\theight: 50,\n\twidth: 50,\n\troomDensity: 0.25,\n\tseed: 313373\n}\n\nexport async function main(root: HTMLElement): Promise<void> {\n\tconst map = box(generateDungeonMap(defaultSettings))\n\n\tconst settings = makeSettingsControl(defaultSettings, settings => {\n\t\tmap.set(generateDungeonMap(settings))\n\t})\n\n\troot.appendChild(tag({class: css.root}, [\n\t\tsettings,\n\t\tmap.map(map => renderDungeonMap(map))\n\t]))\n}","import {Growable2DBitmap} from \"common/growable_2d_bitmap\"\nimport {makeRandomGenerator} from \"common/seeded_random\"\nimport {DungeonMapperSettings} from \"sketches/dungeon_mapper/dungeon_mapper_settings\"\n\ntype DungeonMapPart = {\n\ttype: \"room\" | \"hallway\"\n\tcoords: XY[]\n}\n\nexport type DungeonMap = {\n\tsettings: DungeonMapperSettings\n\t// is this point free (not a wall)?\n\tspaceMap: Growable2DBitmap\n\tparts: DungeonMapPart[]\n}\n\nlet random: () => number = () => 0\n\ntype XY = {x: number, y: number}\n\nexport const generateDungeonMap = (settings: DungeonMapperSettings): DungeonMap => {\n\tconst spaceMap = new Growable2DBitmap(settings.width, settings.height)\n\trandom = makeRandomGenerator(settings.seed)\n\n\tconst rooms = generateRooms(spaceMap, settings)\n\n\treturn {\n\t\tsettings, spaceMap, parts: rooms\n\t}\n}\n\nconst roomSizeLimit = 3 // min size of a room\n\nconst generateRooms = (spaceMap: Growable2DBitmap, settings: DungeonMapperSettings): DungeonMapPart[] => {\n\tlet fillCount = 0\n\tconst rooms: DungeonMapPart[] = []\n\tconst targetFillCount = settings.roomDensity * settings.width * settings.height\n\twhile(fillCount < targetFillCount){\n\t\tconst roomCenter = findRandomEmptySpot(spaceMap, settings)\n\t\tconst fillLimit = targetFillCount - fillCount\n\t\tif(fillLimit < (roomSizeLimit * roomSizeLimit * 4)){\n\t\t\t// limit is too small, we won't be able to ever fill it, let's stop here\n\t\t\tbreak\n\t\t}\n\n\t\tlet ownedCoords: XY[]\n\t\tif(random() > 0.5){\n\t\t\t// generating a circle\n\t\t\tlet radius = findMaxCircleRadius(spaceMap, roomCenter, settings)\n\t\t\tif(radius < roomSizeLimit){ // too small\n\t\t\t\tcontinue\n\t\t\t}\n\n\t\t\tradius = Math.ceil(radius * (0.5 + (random() * 0.5)))\n\t\t\tconst radiusLimit = Math.floor(Math.sqrt(fillLimit / Math.PI))\n\t\t\tradius = Math.min(radiusLimit, radius)\n\n\t\t\townedCoords = fillCircle(spaceMap, roomCenter, radius)\n\t\t\tfillCount += ownedCoords.length\n\t\t} else {\n\t\t\t// generating a rectangle\n\t\t\tconst dims = findMaxRectangleDimensions(spaceMap, roomCenter, settings)\n\t\t\tif(dims.x < roomSizeLimit || dims.y < roomSizeLimit){\n\t\t\t\tcontinue\n\t\t\t}\n\n\t\t\tdims.x = Math.ceil(dims.x * (0.5 + (random() * 0.5)))\n\t\t\tdims.y = Math.ceil(dims.y * (0.5 + (random() * 0.5)))\n\t\t\tconst limitScale = fillLimit / (dims.x * dims.y * 4)\n\t\t\tif(limitScale < 1){\n\t\t\t\tdims.x *= limitScale\n\t\t\t\tdims.y *= limitScale\n\t\t\t}\n\t\t\tdims.x = Math.max(dims.x, roomSizeLimit)\n\t\t\tdims.y = Math.max(dims.y, roomSizeLimit)\n\n\t\t\townedCoords = fillRectangle(spaceMap, roomCenter, dims)\n\t\t\tfillCount += ownedCoords.length\n\t\t}\n\n\t\trooms.push({type: \"room\", coords: ownedCoords})\n\t}\n\tconsole.log(`Filled map with rooms to density = ${(fillCount / (settings.width * settings.height)).toFixed(3)}`)\n\treturn rooms\n}\n\nconst findRandomEmptySpot = (map: Growable2DBitmap, settings: DungeonMapperSettings): XY => {\n\twhile(true){\n\t\tconst x = Math.floor(random() * settings.width)\n\t\tconst y = Math.floor(random() * settings.height)\n\t\tif(!map.get(x, y)){\n\t\t\treturn {x, y}\n\t\t}\n\t}\n}\n\n// this one is random, because depending on growth order different results may be achieved\n// more robust approach would be to use stable metrics like \"max area\",\n// but I don't want to think too hard about it right now\nconst findMaxRectangleDimensions = (map: Growable2DBitmap, center: XY, settings: DungeonMapperSettings): XY => {\n\tlet halfWidth = 0\n\tlet halfHeight = 0\n\tlet canGrowWidth = true\n\tlet canGrowHeight = true\n\twhile(canGrowWidth || canGrowHeight){\n\t\tconst isGrowingHeight = !canGrowWidth ? true : !canGrowHeight ? false : random() > 0.5\n\t\tif(isGrowingHeight){\n\t\t\tif(center.y + halfHeight + 1 >= settings.height || center.y - (halfHeight + 1) < 0){\n\t\t\t\tcanGrowHeight = false\n\t\t\t\tcontinue\n\t\t\t}\n\t\t\thalfHeight++\n\t\t} else {\n\t\t\tif(center.x + halfWidth + 1 >= settings.width || center.x - (halfWidth + 1) < 0){\n\t\t\t\tcanGrowWidth = false\n\t\t\t\tcontinue\n\t\t\t}\n\t\t\thalfWidth++\n\t\t}\n\n\t\tlet isAttemptFailed = false\n\n\t\t{\n\t\t\tconst yMin = center.y - halfHeight\n\t\t\tconst yMax = center.y + halfHeight\n\t\t\tfor(let dx = -halfWidth; dx <= halfWidth; dx++){\n\t\t\t\tconst x = center.x + dx\n\t\t\t\tif(map.get(x, yMin) || map.get(x, yMax)){\n\t\t\t\t\tisAttemptFailed = true\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif(!isAttemptFailed){\n\t\t\tconst xMin = center.x - halfWidth\n\t\t\tconst xMax = center.y + halfWidth\n\t\t\tfor(let dy = -halfHeight; dy <= halfHeight; dy++){\n\t\t\t\tconst y = center.y + dy\n\t\t\t\tif(map.get(xMin, y) || map.get(xMax, y)){\n\t\t\t\t\tisAttemptFailed = true\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif(isAttemptFailed){\n\t\t\tif(isGrowingHeight){\n\t\t\t\thalfHeight--\n\t\t\t\tcanGrowHeight = false\n\t\t\t} else {\n\t\t\t\thalfWidth--\n\t\t\t\tcanGrowWidth = false\n\t\t\t}\n\t\t}\n\n\t}\n\n\treturn {x: halfWidth, y: halfHeight}\n}\n\nconst findMaxCircleRadius = (map: Growable2DBitmap, center: XY, settings: DungeonMapperSettings): number => {\n\tlet radius = 0\n\twhile(true){\n\t\tif(center.x + radius + 1 >= settings.width\n\t\t|| center.x - (radius + 1) < 0\n\t\t|| center.y + radius + 1 >= settings.height\n\t\t|| center.y - (radius + 1) < 0){\n\t\t\treturn radius\n\t\t}\n\t\tradius++\n\t\tfor(let dx = -radius; dx <= radius; dx++){\n\t\t\tconst dy = Math.sqrt((radius * radius) - (dx * dx))\n\t\t\tconst yMin = Math.floor(center.y - dy)\n\t\t\tconst yMax = Math.ceil(center.y + dy)\n\t\t\tconst x = center.x + dx\n\t\t\tif(map.get(x, yMin) || map.get(x, yMax)){\n\t\t\t\treturn radius - 1\n\t\t\t}\n\t\t}\n\t}\n}\n\nconst fillCircle = (map: Growable2DBitmap, center: XY, radius: number): XY[] => {\n\tconst result: XY[] = []\n\tfor(let dx = -radius; dx <= radius; dx++){\n\t\tconst dy = Math.sqrt((radius * radius) - (dx * dx))\n\t\tconst yMin = Math.floor(center.y - dy)\n\t\tconst yMax = Math.ceil(center.y + dy)\n\t\tconst x = center.x + dx\n\t\tfor(let y = yMin; y <= yMax; y++){\n\t\t\tmap.set(x, y)\n\t\t\tresult.push({x, y})\n\t\t}\n\t}\n\treturn result\n}\n\nconst fillRectangle = (map: Growable2DBitmap, center: XY, dims: XY): XY[] => {\n\tconst result: XY[] = []\n\tfor(let x = center.x - dims.x; x <= center.x + dims.x; x++){\n\t\tfor(let y = center.y - dims.y; y <= center.y + dims.y; y++){\n\t\t\tmap.set(x, y)\n\t\t\tresult.push({x, y})\n\t\t}\n\t}\n\treturn result\n}","/** 2d array of booleans that grows\n * x and y could be any int in [0, 2^31) (maybe more!)\n * Just keep in mind that it is always rectangular;\n * that is, if you set (0, 1000) and (1000, 0) - you'll have at least 1000x1000 elements, which may be a lot */\nexport class Growable2DBitmap {\n\n\tprivate widthPow: number\n\tprivate heightPow: number\n\tprivate width: number\n\tprivate height: number\n\tprivate data: Uint8Array\n\n\tconstructor(initialWidth = 32, initialHeight = 32) {\n\t\tthis.widthPow = Math.ceil(Math.log2(Math.max(8, Math.ceil(initialWidth))))\n\t\tthis.heightPow = Math.ceil(Math.log2(Math.max(8, Math.ceil(initialHeight))))\n\t\tthis.width = 1 << this.widthPow\n\t\tthis.height = 1 << this.heightPow\n\t\tthis.data = new Uint8Array((this.width * this.height) >> 3)\n\t}\n\n\t// keep in mind that actual width could differ from passed values in constructor\n\tget actualWidth(): number {\n\t\treturn this.width\n\t}\n\n\tget actualHeight(): number {\n\t\treturn this.height\n\t}\n\n\tget(x: number, y: number): boolean {\n\t\tif(x >= this.width || y >= this.height){\n\t\t\treturn false\n\t\t}\n\t\tconst byteIndex = ((y << this.widthPow) + x) >> 3\n\t\tconst byte = this.data[byteIndex]!\n\t\treturn !!(byte & (1 << (x & 0x7)))\n\t}\n\n\tset(x: number, y: number): void {\n\t\tif(x >= this.width){\n\t\t\tthis.growWidth(this.calcSteps(x, this.width))\n\t\t}\n\n\t\tif(y >= this.height){\n\t\t\tthis.growHeight(this.calcSteps(y, this.height))\n\t\t}\n\n\t\tconst byteIndex = ((y << this.widthPow) + x) >> 3\n\t\tthis.data[byteIndex] |= 1 << (x & 0x7)\n\t}\n\n\treset(x: number, y: number): void {\n\t\tif(x >= this.width){\n\t\t\tthis.growWidth(this.calcSteps(x, this.width))\n\t\t}\n\n\t\tif(y >= this.height){\n\t\t\tthis.growHeight(this.calcSteps(y, this.height))\n\t\t}\n\n\t\tconst byteIndex = ((y << this.widthPow) + x) >> 3\n\t\tthis.data[byteIndex] &= ~(1 << (x & 0x7))\n\t}\n\n\tsetRect(_x: number, _y: number, xLength: number, yLength: number): void {\n\t\tconst xLim = _x + xLength\n\t\tif(xLim >= this.width){\n\t\t\tthis.growWidth(this.calcSteps(xLim, this.width))\n\t\t}\n\n\t\tconst yLim = _y + yLength\n\t\tif(yLim > this.height){\n\t\t\tthis.growHeight(this.calcSteps(yLim, this.height))\n\t\t}\n\n\t\tconst rowStartIndex = _x >> 3\n\t\tconst rowEndIndex = xLim >> 3\n\n\t\tlet startMask = 0xff & ~((1 << (_x & 0x7)) - 1)\n\t\tlet endMask = (1 << (xLim & 0x7)) - 1\n\t\tif(rowStartIndex === rowEndIndex){\n\t\t\tstartMask &= endMask\n\t\t\tendMask = startMask\n\t\t}\n\n\t\tfor(let y = _y; y < yLim; y++){\n\t\t\tlet mask = startMask\n\t\t\tconst rowOffset = _y << this.widthPow\n\t\t\tfor(let rowIndex = rowStartIndex; rowIndex < rowEndIndex; rowIndex++){\n\t\t\t\tconst byte = this.data[rowIndex + rowOffset]!\n\t\t\t\tthis.data[rowIndex + rowOffset] = byte | mask\n\t\t\t\tmask = 0xff\n\t\t\t}\n\t\t\tconst byte = this.data[rowEndIndex + rowOffset]!\n\t\t\tthis.data[rowEndIndex + rowOffset] = byte | endMask\n\t\t}\n\t}\n\n\thasAnyInRect(_x: number, _y: number, xLength: number, yLength: number): boolean {\n\t\tconst xLim = Math.min(_x + xLength, this.width)\n\t\tconst yLim = Math.min(_y + yLength, this.height)\n\n\t\tconst rowStartIndex = _x >> 3\n\t\tconst rowEndIndex = xLim >> 3\n\n\t\tlet startMask = 0xff & ~((1 << (_x & 0x7)) - 1)\n\t\tlet endMask = (1 << (xLim & 0x7)) - 1\n\t\tif(rowStartIndex === rowEndIndex){\n\t\t\tstartMask &= endMask\n\t\t\tendMask = startMask\n\t\t}\n\t\t// console.log(\"start mask: \" + startMask.toString(2))\n\t\t// console.log(\"end mask: \" + endMask.toString(2))\n\t\t// console.log({rowStartIndex, rowEndIndex, _x, xLim})\n\n\t\tfor(let y = _y; y < yLim; y++){\n\t\t\tlet mask = startMask\n\t\t\tconst rowOffset = _y << this.widthPow\n\t\t\tfor(let rowIndex = rowStartIndex; rowIndex < rowEndIndex; rowIndex++){\n\t\t\t\tconst byte = this.data[rowIndex + rowOffset]!\n\t\t\t\tif(byte & mask){\n\t\t\t\t\treturn true\n\t\t\t\t}\n\t\t\t\tmask = 0xff\n\t\t\t}\n\t\t\tconst byte = this.data[rowEndIndex + rowOffset]!\n\t\t\t// console.log(byte.toString(2) + \" & \" + endMask.toString(2) + \" = \" + (byte & endMask).toString(2))\n\t\t\tif(byte & endMask){\n\t\t\t\treturn true\n\t\t\t}\n\t\t}\n\n\t\treturn false\n\t}\n\n\tprivate calcSteps(requiredSize: number, currentSize: number): number {\n\t\tlet growthSteps = 1\n\t\twhile(requiredSize > (currentSize << growthSteps)){\n\t\t\tgrowthSteps++\n\t\t}\n\t\treturn growthSteps\n\t}\n\n\tprivate growWidth(steps: number): void {\n\t\t// this is kinda ugly.\n\t\t// but I don't have a good idea how to make this better\n\t\tconst newWidth = this.width << steps\n\t\tconst newWidthPow = this.widthPow + steps\n\t\tconst newArr = new Uint8Array((this.height * (this.width << steps)) >> 3)\n\t\tfor(let y = 0; y < this.height; y++){\n\t\t\tfor(let x = 0; x < this.width; x++){\n\t\t\t\tconst oldByteIndex = ((y << this.widthPow) + x) >> 3\n\t\t\t\tconst newByteIndex = ((y << newWidthPow) + x) >> 3\n\t\t\t\tnewArr[newByteIndex] = this.data[oldByteIndex]!\n\t\t\t}\n\t\t}\n\t\tthis.data = newArr\n\t\tthis.widthPow = newWidthPow\n\t\tthis.width = newWidth\n\t}\n\n\tprivate growHeight(steps: number): void {\n\t\tconst len = this.data.length\n\t\tthis.height <<= steps\n\t\tthis.heightPow += steps\n\t\tconst newArr = new Uint8Array((this.width * this.height) >> 3)\n\t\tfor(let i = 0; i < len; i++){\n\t\t\tnewArr[i] = this.data[i]!\n\t\t}\n\t\tthis.data = newArr\n\t}\n\n\ttoString(): string {\n\t\tlet result = \"\"\n\t\tfor(let y = 0; y < this.height; y++){\n\t\t\tfor(let x = 0; x < this.width; x++){\n\t\t\t\tresult += this.get(x, y) ? \"x \" : \". \"\n\t\t\t}\n\t\t\tif(y !== this.height - 1){\n\t\t\t\tresult += \"\\n\"\n\t\t\t}\n\t\t}\n\t\treturn result\n\t}\n\n\tupscale(factor: number): Growable2DBitmap {\n\t\t// this really could be more optimal, but whatever\n\t\tconst result = new Growable2DBitmap(this.width * factor, this.height * factor)\n\t\tfor(let x = 0; x < this.width; x++){\n\t\t\tfor(let y = 0; y < this.height; y++){\n\t\t\t\tif(this.get(x, y)){\n\t\t\t\t\tconst startX = x * factor\n\t\t\t\t\tconst startY = y * factor\n\t\t\t\t\tfor(let dx = 0; dx < factor; dx++){\n\t\t\t\t\t\tfor(let dy = 0; dy < factor; dy++){\n\t\t\t\t\t\t\tresult.set(startX + dx, startY + dy)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn result\n\t}\n\n}\n","export const makeRandomGenerator = (seed: number): () => number => {\n\tconst m = 2 ** 35 - 31\n\tconst a = 185852\n\tlet s = seed % m\n\treturn () => (s = (s * a) % m) / m\n}","import {tag} from \"@nartallax/cardboard-dom\"\nimport * as css from \"./dungeon_mapper.module.scss\"\n\nexport type DungeonMapperSettings = {\n\tseed: number\n\twidth: number\n\theight: number\n\t// 0-1, how much of the map belongs to rooms\n\t// higher values = longer gen time, up to infinity\n\troomDensity: number\n\t// 1-inf\n\taverageRoomConnectionsCount: number\n}\n\nexport const makeSettingsControl = (defaultSettings: DungeonMapperSettings, onChange: (settings: DungeonMapperSettings) => void) => {\n\tlet settings = {...defaultSettings}\n\treturn tag({class: css.inputsColumn}, [\n\t\tmakeInput({\n\t\t\tlabel: \"Seed\",\n\t\t\tmin: Number.MIN_SAFE_INTEGER,\n\t\t\tmax: Number.MAX_SAFE_INTEGER,\n\t\t\tdefaultValue: defaultSettings.seed,\n\t\t\tonChange: seed => onChange(settings = {...settings, seed}),\n\t\t\trightButton: {\n\t\t\t\ttext: \"Roll\",\n\t\t\t\tonClick: input => input.value = (Math.floor(Math.random() * 0xffffffff) + \"\")\n\t\t\t}\n\t\t}),\n\t\tmakeInput({\n\t\t\tlabel: \"Width\",\n\t\t\tmin: 1,\n\t\t\tmax: 100,\n\t\t\tdefaultValue: defaultSettings.width,\n\t\t\tonChange: width => onChange(settings = {...settings, width}),\n\t\t\tleftButton: {text: \"-\", onClick: (input, value) => input.value = (value - 1) + \"\"},\n\t\t\trightButton: {text: \"+\", onClick: (input, value) => input.value = (value + 1) + \"\"}\n\t\t}),\n\t\tmakeInput({\n\t\t\tlabel: \"Height\",\n\t\t\tmin: 1,\n\t\t\tmax: 100,\n\t\t\tdefaultValue: defaultSettings.height,\n\t\t\tonChange: height => onChange(settings = {...settings, height}),\n\t\t\tleftButton: {text: \"-\", onClick: (input, value) => input.value = (value - 1) + \"\"},\n\t\t\trightButton: {text: \"+\", onClick: (input, value) => input.value = (value + 1) + \"\"}\n\t\t}),\n\t\tmakeInput({\n\t\t\tlabel: \"Density\",\n\t\t\tmin: 0.25,\n\t\t\tmax: 0.75,\n\t\t\tdefaultValue: defaultSettings.roomDensity,\n\t\t\tonChange: roomDensity => onChange(settings = {...settings, roomDensity}),\n\t\t\tleftButton: {text: \"-\", onClick: (input, value) => input.value = (value - 0.05) + \"\"},\n\t\t\trightButton: {text: \"+\", onClick: (input, value) => input.value = (value + 0.05) + \"\"}\n\t\t}),\n\t\tmakeInput({\n\t\t\tlabel: \"Connections\",\n\t\t\tmin: 1,\n\t\t\tmax: 5,\n\t\t\tdefaultValue: defaultSettings.averageRoomConnectionsCount,\n\t\t\tonChange: averageRoomConnectionsCount => onChange(settings = {...settings, averageRoomConnectionsCount}),\n\t\t\tleftButton: {text: \"-\", onClick: (input, value) => input.value = (value - 0.25) + \"\"},\n\t\t\trightButton: {text: \"+\", onClick: (input, value) => input.value = (value + 0.25) + \"\"}\n\t\t})\n\t])\n\n}\n\ntype ButtonOpts = {text: string, onClick: (input: HTMLInputElement, value: number) => void}\n\ntype InputOpts = {\n\tlabel: string\n\tleftButton?: ButtonOpts\n\trightButton?: ButtonOpts\n\tdefaultValue: number\n\tmin: number\n\tmax: number\n\tonChange: (newValue: number) => void\n}\nconst makeInput = (opts: InputOpts): HTMLElement => {\n\tlet lastKnownValue = opts.defaultValue\n\n\tconst makeButton = (opts?: ButtonOpts): HTMLElement | null => !opts ? null : tag({\n\t\ttag: \"input\",\n\t\tattrs: {type: \"button\", value: opts.text},\n\t\tonClick: () => {\n\t\t\topts.onClick(input, lastKnownValue)\n\t\t\tcheckChange(true)\n\t\t}\n\t})\n\n\tconst checkChange = (allowUpdate: boolean) => {\n\t\tlet value = parseFloat(input.value)\n\t\tif(value === lastKnownValue){\n\t\t\treturn\n\t\t}\n\n\t\tif(Number.isNaN(value)){\n\t\t\tvalue = opts.defaultValue\n\t\t}\n\t\tif(value < opts.min){\n\t\t\tvalue = opts.min\n\t\t}\n\t\tif(value > opts.max){\n\t\t\tvalue = opts.max\n\t\t}\n\t\tif(value !== lastKnownValue && allowUpdate){\n\t\t\tinput.value = value + \"\"\n\t\t}\n\t\tlastKnownValue = value\n\t\topts.onChange(value)\n\t}\n\n\tconst input = tag({\n\t\ttag: \"input\",\n\t\tattrs: {\n\t\t\ttype: \"text\"\n\t\t},\n\t\tonBlur: () => checkChange(true),\n\t\tonKeyup: () => checkChange(false),\n\t\tonChange: () => checkChange(false)\n\t})\n\n\tinput.value = lastKnownValue + \"\"\n\tconst leftButton = makeButton(opts.leftButton)\n\tconst rightButton = makeButton(opts.rightButton)\n\n\tconst result = tag({class: css.inputWrap}, [\n\t\ttag({class: css.inputLabel}, [opts.label]),\n\t\tleftButton,\n\t\tinput,\n\t\trightButton\n\t])\n\n\treturn result\n\n}",".root {\n  display: flex;\n  flex-direction: row;\n  align-items: stretch;\n  width: 100%;\n  height: 100%;\n}\n\n.mapContainer {\n  flex: 1 1 0;\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n\n  .mapColumn {\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n\n    .mapSquare {\n      width: 10px;\n      height: 10px;\n\n      &.empty {\n        background-color: #444;\n      }\n\n      &.full {\n        background-color: #888;\n      }\n    }\n  }\n}\n\n.inputsColumn {\n  flex: 0 0 auto;\n  padding: 4px;\n\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  gap: 4px;\n  width: 200px;\n\n  .inputWrap {\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n\n    .inputLabel {\n      width: 100px;\n      flex: 0 0 auto;\n      color: #fff;\n    }\n\n    input[type=\"text\"] {\n      width: 50px;\n      flex: 0 0 auto;\n    }\n\n    input[type=\"button\"] {\n      flex: 1 1 0;\n    }\n  }\n}\n","import {DungeonMap} from \"sketches/dungeon_mapper/dungeon_mapper_generator\"\nimport * as css from \"./dungeon_mapper.module.scss\"\nimport {tag} from \"@nartallax/cardboard-dom\"\n\nexport const renderDungeonMap = (map: DungeonMap): HTMLElement => {\n\tconst result = tag({class: css.mapContainer})\n\tfor(let x = 0; x < map.settings.width; x++){\n\t\tconst column = tag({class: css.mapColumn})\n\t\tresult.appendChild(column)\n\t\tfor(let y = 0; y < map.settings.height; y++){\n\t\t\tconst square = tag({\n\t\t\t\tclass: [\n\t\t\t\t\tcss.mapSquare,\n\t\t\t\t\tmap.spaceMap.get(x, y) ? css.empty : css.full\n\t\t\t\t].join(\" \")\n\t\t\t})\n\t\t\tcolumn.appendChild(square)\n\t\t}\n\t}\n\treturn result\n}"],"names":["$9H5KT","parcelRequire","$df44c8bda6c62eff$var$defaultSettings","averageRoomConnectionsCount","height","width","roomDensity","seed","async","$df44c8bda6c62eff$export$f22da7240b7add18","root","map","box","$9GiM0","generateDungeonMap","settings","$eS6ox","makeSettingsControl","set","appendChild","$7sHgZ","tag","class","$ea7DN","$5JZ8T","renderDungeonMap","$gFMBO","$5c4adda9f2382e9b$var$random","$5c4adda9f2382e9b$export$fbf0e6042a0d87e1","spaceMap","Growable2DBitmap","$fH3rR","makeRandomGenerator","parts","$5c4adda9f2382e9b$var$generateRooms","fillCount","rooms","targetFillCount","roomCenter","$5c4adda9f2382e9b$var$findRandomEmptySpot","fillLimit","$5c4adda9f2382e9b$var$roomSizeLimit","ownedCoords","radius","$5c4adda9f2382e9b$var$findMaxCircleRadius","Math","ceil","radiusLimit","floor","sqrt","PI","min","$5c4adda9f2382e9b$var$fillCircle","length","dims","$5c4adda9f2382e9b$var$findMaxRectangleDimensions","x","y","limitScale","max","$5c4adda9f2382e9b$var$fillRectangle","push","type","coords","console","log","toFixed","get","center","halfWidth","halfHeight","canGrowWidth","canGrowHeight","isGrowingHeight","isAttemptFailed","yMin","yMax","dx","xMin","xMax","dy","result","$f542ab6b6a186fba$export$797e508ae7f4e408","constructor","initialWidth","initialHeight","this","widthPow","log2","heightPow","data","Uint8Array","actualWidth","actualHeight","byteIndex","growWidth","calcSteps","growHeight","reset","setRect","_x","_y","xLength","yLength","xLim","yLim","rowStartIndex","rowEndIndex","startMask","endMask","mask","rowOffset","rowIndex","byte","byte1","hasAnyInRect","requiredSize","currentSize","growthSteps","steps","newWidth","newWidthPow","newArr","oldByteIndex","len","i","toString","upscale","factor","startX","startY","$fa672a406b773481$export$211cdad63e59713b","m","s","$f4600a5993adb2b6$export$5fdcc77b1cf8399a","defaultSettings","onChange","inputsColumn","$f4600a5993adb2b6$var$makeInput","label","Number","MIN_SAFE_INTEGER","MAX_SAFE_INTEGER","defaultValue","rightButton","text","onClick","input","value","random","leftButton","opts","lastKnownValue","makeButton","attrs","checkChange","allowUpdate","parseFloat","isNaN","onBlur","onKeyup","inputWrap","inputLabel","$a4f7ed2f40948ddc$export$db8544a5107bbfb7","$a4f7ed2f40948ddc$export$4bb2b25269bbecf7","$a4f7ed2f40948ddc$export$9020dd291e2f7bce","$a4f7ed2f40948ddc$export$b76af709b52e7487","$a4f7ed2f40948ddc$export$eeaa29c84a891f3b","$a4f7ed2f40948ddc$export$6e22c362a0406a2c","$a4f7ed2f40948ddc$export$2adb16ac204af30e","$a4f7ed2f40948ddc$export$e8e78c978b129247","$a4f7ed2f40948ddc$export$8a5f1876d197d279","$ee1981969f4d90d4$export$2abe6dbc3ba76968","mapContainer","column","mapColumn","square","mapSquare","empty","full","join"],"version":3,"file":"dungeon_mapper.1a1b0520.js.map"}