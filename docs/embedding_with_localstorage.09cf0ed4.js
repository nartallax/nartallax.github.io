var e=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequirebf86;e.register("7BCiZ",(function(t,n){var s,a,r,o;s=t.exports,a="main",r=()=>l,Object.defineProperty(s,a,{get:r,set:o,enumerable:!0,configurable:!0});var i=e("7sHgZ");const c="test_value_key",l=e=>{const t=new u("test_db_name"),n=(0,i.tag)({tag:"input",attrs:{placeholder:"Local storage value",type:"text",value:localStorage[c]??""}}),s=(0,i.tag)({tag:"input",attrs:{placeholder:"indexeddb value",type:"text"}});e.appendChild(n),e.appendChild(s),(async()=>{s.value=await t.get(c)??""})();const a=()=>{localStorage[c]=n.value},r=()=>{t.set(c,s.value)};for(const[e,t]of[[n,a],[s,r]])e.addEventListener("keydown",t),e.addEventListener("change",t),e.addEventListener("paste",t)};class u{constructor(e){this.dbName=e,this.dbVersion=1,this.storeName="default_store"}migrate(e){const t=e.createObjectStore(this.storeName);return new Promise(((e,n)=>{t.transaction.onerror=e=>n(e),t.transaction.oncomplete=()=>e()}))}async getDb(){return new Promise(((e,t)=>{const n=window.indexedDB.open(this.dbName,this.dbVersion);n.onerror=e=>{t(e)},n.onsuccess=t=>{e(t.target.result)},n.onupgradeneeded=async t=>{const n=t.target.result;await this.migrate(n),e(n)}}))}async inTransaction(e,t){const n=e.transaction([this.storeName],"readwrite"),s=n.objectStore(this.storeName);let a=null,r=!1,o=!1,i=null;const c=new Promise(((e,t)=>{i=e,n.oncomplete=()=>{o=!0,r&&e(a)},n.onerror=e=>t(e)}));return a=await t(s,n),r=!0,o&&i(a),c}performPutRequest(e,t,n){const s=e.put(n,t);return new Promise(((e,t)=>{s.onerror=e=>t(e),s.onsuccess=()=>e()}))}performGetRequest(e,t){const n=e.get(t);return new Promise(((e,t)=>{n.onerror=e=>t(e),n.onsuccess=t=>e(t.target.result)}))}performDeleteRequest(e,t){const n=e.delete(t);return new Promise(((e,t)=>{n.onerror=e=>t(e),n.onsuccess=()=>e}))}async get(e){const t=await this.getDb();return await this.inTransaction(t,(async t=>await this.performGetRequest(t,e)))}async set(e,t){const n=await this.getDb();await this.inTransaction(n,(async n=>{await this.performPutRequest(n,e,t)}))}async delete(e){const t=await this.getDb();await this.inTransaction(t,(async t=>{await this.performDeleteRequest(t,e)}))}}}));
//# sourceMappingURL=embedding_with_localstorage.09cf0ed4.js.map
