function t(t,e,i,o){Object.defineProperty(t,e,{get:i,set:o,enumerable:!0,configurable:!0})}var e=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequirebf86;e.register("cjDlI",(function(i,o){t(i.exports,"main",(()=>u));var h=e("9H5KT"),n=e("9GiM0"),s=e("eS6ox"),a=e("ea7DN"),r=e("7sHgZ"),l=e("5JZ8T");const c={averageRoomConnectionsCount:2,height:50,width:50,roomDensity:.25,seed:313373};async function u(t){const e=(0,h.box)((0,n.generateDungeonMap)(c)),i=(0,s.makeSettingsControl)(c,(t=>{e.set((0,n.generateDungeonMap)(t))}));t.appendChild((0,r.tag)({class:a.root},[i,e.map((t=>(0,l.renderDungeonMap)(t)))]))}})),e.register("9GiM0",(function(i,o){t(i.exports,"generateDungeonMap",(()=>a));var h=e("gFMBO"),n=e("fH3rR");let s=()=>0;const a=t=>{const e=new(0,h.Growable2DBitmap)(t.width,t.height);s=(0,n.makeRandomGenerator)(t.seed);return{settings:t,spaceMap:e,parts:r(e,t)}},r=(t,e)=>{let i=0;const o=[],h=e.roomDensity*e.width*e.height;for(;i<h;){const n=l(t,e),a=h-i;if(a<36)break;let r;if(s()>.5){let o=u(t,n,e);if(o<3)continue;o=Math.ceil(o*(.5+.5*s()));const h=Math.floor(Math.sqrt(a/Math.PI));o=Math.min(h,o),r=g(t,n,o),i+=r.length}else{const o=c(t,n,e);if(o.x<3||o.y<3)continue;o.x=Math.ceil(o.x*(.5+.5*s())),o.y=Math.ceil(o.y*(.5+.5*s()));const h=a/(o.x*o.y*4);h<1&&(o.x*=h,o.y*=h),o.x=Math.max(o.x,3),o.y=Math.max(o.y,3),r=d(t,n,o),i+=r.length}o.push({type:"room",coords:r})}return console.log(`Filled map with rooms to density = ${(i/(e.width*e.height)).toFixed(3)}`),o},l=(t,e)=>{for(;;){const i=Math.floor(s()*e.width),o=Math.floor(s()*e.height);if(!t.get(i,o))return{x:i,y:o}}},c=(t,e,i)=>{let o=0,h=0,n=!0,a=!0;for(;n||a;){const r=!n||!!a&&s()>.5;if(r){if(e.y+h+1>=i.height||e.y-(h+1)<0){a=!1;continue}h++}else{if(e.x+o+1>=i.width||e.x-(o+1)<0){n=!1;continue}o++}let l=!1;{const i=e.y-h,n=e.y+h;for(let h=-o;h<=o;h++){const o=e.x+h;if(t.get(o,i)||t.get(o,n)){l=!0;break}}}if(!l){const i=e.x-o,n=e.y+o;for(let o=-h;o<=h;o++){const h=e.y+o;if(t.get(i,h)||t.get(n,h)){l=!0;break}}}l&&(r?(h--,a=!1):(o--,n=!1))}return{x:o,y:h}},u=(t,e,i)=>{let o=0;for(;;){if(e.x+o+1>=i.width||e.x-(o+1)<0||e.y+o+1>=i.height||e.y-(o+1)<0)return o;o++;for(let i=-o;i<=o;i++){const h=Math.sqrt(o*o-i*i),n=Math.floor(e.y-h),s=Math.ceil(e.y+h),a=e.x+i;if(t.get(a,n)||t.get(a,s))return o-1}}},g=(t,e,i)=>{const o=[];for(let h=-i;h<=i;h++){const n=Math.sqrt(i*i-h*h),s=Math.floor(e.y-n),a=Math.ceil(e.y+n),r=e.x+h;for(let e=s;e<=a;e++)t.set(r,e),o.push({x:r,y:e})}return o},d=(t,e,i)=>{const o=[];for(let h=e.x-i.x;h<=e.x+i.x;h++)for(let n=e.y-i.y;n<=e.y+i.y;n++)t.set(h,n),o.push({x:h,y:n});return o}})),e.register("gFMBO",(function(e,i){t(e.exports,"Growable2DBitmap",(()=>o));class o{constructor(t=32,e=32){this.widthPow=Math.ceil(Math.log2(Math.max(8,Math.ceil(t)))),this.heightPow=Math.ceil(Math.log2(Math.max(8,Math.ceil(e)))),this.width=1<<this.widthPow,this.height=1<<this.heightPow,this.data=new Uint8Array(this.width*this.height>>3)}get actualWidth(){return this.width}get actualHeight(){return this.height}get(t,e){if(t>=this.width||e>=this.height)return!1;const i=(e<<this.widthPow)+t>>3;return!!(this.data[i]&1<<(7&t))}set(t,e){t>=this.width&&this.growWidth(this.calcSteps(t,this.width)),e>=this.height&&this.growHeight(this.calcSteps(e,this.height));const i=(e<<this.widthPow)+t>>3;this.data[i]|=1<<(7&t)}reset(t,e){t>=this.width&&this.growWidth(this.calcSteps(t,this.width)),e>=this.height&&this.growHeight(this.calcSteps(e,this.height));const i=(e<<this.widthPow)+t>>3;this.data[i]&=~(1<<(7&t))}setRect(t,e,i,o){const h=t+i;h>=this.width&&this.growWidth(this.calcSteps(h,this.width));const n=e+o;n>this.height&&this.growHeight(this.calcSteps(n,this.height));const s=t>>3,a=h>>3;let r=255&~((1<<(7&t))-1),l=(1<<(7&h))-1;s===a&&(r&=l,l=r);for(let t=e;t<n;t++){let t=r;const i=e<<this.widthPow;for(let e=s;e<a;e++){const o=this.data[e+i];this.data[e+i]=o|t,t=255}const o=this.data[a+i];this.data[a+i]=o|l}}hasAnyInRect(t,e,i,o){const h=Math.min(t+i,this.width),n=Math.min(e+o,this.height),s=t>>3,a=h>>3;let r=255&~((1<<(7&t))-1),l=(1<<(7&h))-1;s===a&&(r&=l,l=r);for(let t=e;t<n;t++){let t=r;const i=e<<this.widthPow;for(let e=s;e<a;e++){if(this.data[e+i]&t)return!0;t=255}if(this.data[a+i]&l)return!0}return!1}calcSteps(t,e){let i=1;for(;t>e<<i;)i++;return i}growWidth(t){const e=this.width<<t,i=this.widthPow+t,o=new Uint8Array(this.height*(this.width<<t)>>3);for(let t=0;t<this.height;t++)for(let e=0;e<this.width;e++){const h=(t<<this.widthPow)+e>>3;o[(t<<i)+e>>3]=this.data[h]}this.data=o,this.widthPow=i,this.width=e}growHeight(t){const e=this.data.length;this.height<<=t,this.heightPow+=t;const i=new Uint8Array(this.width*this.height>>3);for(let t=0;t<e;t++)i[t]=this.data[t];this.data=i}toString(){let t="";for(let e=0;e<this.height;e++){for(let i=0;i<this.width;i++)t+=this.get(i,e)?"x ":". ";e!==this.height-1&&(t+="\n")}return t}upscale(t){const e=new o(this.width*t,this.height*t);for(let i=0;i<this.width;i++)for(let o=0;o<this.height;o++)if(this.get(i,o)){const h=i*t,n=o*t;for(let i=0;i<t;i++)for(let o=0;o<t;o++)e.set(h+i,n+o)}return e}}})),e.register("fH3rR",(function(e,i){t(e.exports,"makeRandomGenerator",(()=>o));const o=t=>{const e=2**35-31;let i=t%e;return()=>(i=185852*i%e)/e}})),e.register("eS6ox",(function(i,o){t(i.exports,"makeSettingsControl",(()=>s));var h=e("7sHgZ"),n=e("ea7DN");const s=(t,e)=>{let i={...t};return(0,h.tag)({class:n.inputsColumn},[a({label:"Seed",min:Number.MIN_SAFE_INTEGER,max:Number.MAX_SAFE_INTEGER,defaultValue:t.seed,onChange:t=>e(i={...i,seed:t}),rightButton:{text:"Roll",onClick:t=>t.value=Math.floor(4294967295*Math.random())+""}}),a({label:"Width",min:1,max:100,defaultValue:t.width,onChange:t=>e(i={...i,width:t}),leftButton:{text:"-",onClick:(t,e)=>t.value=e-1+""},rightButton:{text:"+",onClick:(t,e)=>t.value=e+1+""}}),a({label:"Height",min:1,max:100,defaultValue:t.height,onChange:t=>e(i={...i,height:t}),leftButton:{text:"-",onClick:(t,e)=>t.value=e-1+""},rightButton:{text:"+",onClick:(t,e)=>t.value=e+1+""}}),a({label:"Density",min:.25,max:.75,defaultValue:t.roomDensity,onChange:t=>e(i={...i,roomDensity:t}),leftButton:{text:"-",onClick:(t,e)=>t.value=e-.05+""},rightButton:{text:"+",onClick:(t,e)=>t.value=e+.05+""}}),a({label:"Connections",min:1,max:5,defaultValue:t.averageRoomConnectionsCount,onChange:t=>e(i={...i,averageRoomConnectionsCount:t}),leftButton:{text:"-",onClick:(t,e)=>t.value=e-.25+""},rightButton:{text:"+",onClick:(t,e)=>t.value=e+.25+""}})])},a=t=>{let e=t.defaultValue;const i=t=>t?(0,h.tag)({tag:"input",attrs:{type:"button",value:t.text},onClick:()=>{t.onClick(s,e),o(!0)}}):null,o=i=>{let o=parseFloat(s.value);o!==e&&(Number.isNaN(o)&&(o=t.defaultValue),o<t.min&&(o=t.min),o>t.max&&(o=t.max),o!==e&&i&&(s.value=o+""),e=o,t.onChange(o))},s=(0,h.tag)({tag:"input",attrs:{type:"text"},onBlur:()=>o(!0),onKeyup:()=>o(!1),onChange:()=>o(!1)});s.value=e+"";const a=i(t.leftButton),r=i(t.rightButton);return(0,h.tag)({class:n.inputWrap},[(0,h.tag)({class:n.inputLabel},[t.label]),a,s,r])}})),e.register("ea7DN",(function(e,i){var o,h,n,s,a,r,l,c,u;t(e.exports,"inputWrap",(()=>o),(t=>o=t)),t(e.exports,"mapColumn",(()=>h),(t=>h=t)),t(e.exports,"inputLabel",(()=>n),(t=>n=t)),t(e.exports,"full",(()=>s),(t=>s=t)),t(e.exports,"mapContainer",(()=>a),(t=>a=t)),t(e.exports,"inputsColumn",(()=>r),(t=>r=t)),t(e.exports,"root",(()=>l),(t=>l=t)),t(e.exports,"mapSquare",(()=>c),(t=>c=t)),t(e.exports,"empty",(()=>u),(t=>u=t)),o="DNc4yq_inputWrap",h="DNc4yq_mapColumn",n="DNc4yq_inputLabel",s="DNc4yq_full",a="DNc4yq_mapContainer",r="DNc4yq_inputsColumn",l="DNc4yq_root",c="DNc4yq_mapSquare",u="DNc4yq_empty"})),e.register("5JZ8T",(function(i,o){t(i.exports,"renderDungeonMap",(()=>s));var h=e("ea7DN"),n=e("7sHgZ");const s=t=>{const e=(0,n.tag)({class:h.mapContainer});for(let i=0;i<t.settings.width;i++){const o=(0,n.tag)({class:h.mapColumn});e.appendChild(o);for(let e=0;e<t.settings.height;e++){const s=(0,n.tag)({class:[h.mapSquare,t.spaceMap.get(i,e)?h.empty:h.full].join(" ")});o.appendChild(s)}}return e}}));
//# sourceMappingURL=dungeon_mapper.818f7495.js.map
